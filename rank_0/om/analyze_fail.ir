# ===============================================================================================
# The following shows the last analyze fail log message.
# ===============================================================================================

----------------------------------------------------
- Caught exception:
----------------------------------------------------
For 'ReduceMean', the second input type should be tensor or scalar, but got invalid abstract type:AbstractKeywordArg.

----------------------------------------------------
- C++ Call Stack: (For framework developers)
----------------------------------------------------
mindspore/core/ops/op_utils.cc:264 CheckAndGetAxisValue

----------------------------------------------------
- The Traceback of Net Construct Code:
----------------------------------------------------
# 0 In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:35
        embedding_loss, z_q, perplexity, _, _ = self.vector_quantization(
# 1 In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69
        e_mean = ops.mean(min_encodings, dim=0)
                 ^
# 2 In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:63
            ops.mean((z_q - ops.stop_gradient(z)).pow(2))
            ^
# 3 In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443
    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)
           ^

# ===============================================================================================
# The following shows the IR when the function graphs evaluation fails to help locate the problem.
# You can search the last ------------------------> to the node which is evaluated failure.
# Refer to https://www.mindspore.cn/search?inputValue=analyze_fail.ir to get more instructions.
# ===============================================================================================

# IR entry: @videogvt_models_vqvae_vqvae_VQVAE_construct_23
# Total subgraphs: 121

# Total params: 8
# Params:
%para1_x : <null>
%para2_pre_quantization_conv.weight : <Ref[Tensor[Float32]], (64, 128, 1, 1), ref_key=:pre_quantization_conv.weight>  :  has_default
%para3_vector_quantization.embedding.embedding_table : <Ref[Tensor[Float32]], (512, 64), ref_key=:vector_quantization.embedding.embedding_table>  :  has_default
%para4_encoder.conv_stack.0.weight : <Ref[Tensor[Float32]], (64, 3, 4, 4), ref_key=:encoder.conv_stack.0.weight>  :  has_default
%para5_encoder.conv_stack.2.weight : <Ref[Tensor[Float32]], (128, 64, 4, 4), ref_key=:encoder.conv_stack.2.weight>  :  has_default
%para6_encoder.conv_stack.4.weight : <Ref[Tensor[Float32]], (128, 128, 3, 3), ref_key=:encoder.conv_stack.4.weight>  :  has_default
%para7_encoder.conv_stack.5.stack.0.res_block.1.weight : <Ref[Tensor[Float32]], (32, 128, 3, 3), ref_key=:encoder.conv_stack.5.stack.0.res_block.1.weight>  :  has_default
%para8_encoder.conv_stack.5.stack.0.res_block.3.weight : <Ref[Tensor[Float32]], (128, 32, 1, 1), ref_key=:encoder.conv_stack.5.stack.0.res_block.3.weight>  :  has_default

subgraph attr:
subgraph instance: videogvt_models_vqvae_vqvae_VQVAE_construct_23 : 0x16b29bf0
# In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:30/    def construct(self, x, verbose=False):/
subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23(%para1_x, %para2_pre_quantization_conv.weight, %para3_vector_quantization.embedding.embedding_table, %para4_encoder.conv_stack.0.weight, %para5_encoder.conv_stack.2.weight, %para6_encoder.conv_stack.4.weight, %para7_encoder.conv_stack.5.stack.0.res_block.1.weight, %para8_encoder.conv_stack.5.stack.0.res_block.3.weight) {
  %1(z_e) = call @videogvt_models_vqvae_encoder_Encoder_construct_31(%para1_x)
      : (<Tensor[Float32], (2, 3, 225, 225)>) -> (<Tensor[Float32], (2, 128, 56, 56)>)
      #scope: (Default)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:32/        z_e = self.encoder(x)/
  %2(z_e) = call @mindspore_nn_layer_conv_Conv2d_construct_32(%1)
      : (<Tensor[Float32], (2, 128, 56, 56)>) -> (<Tensor[Float32], (2, 64, 56, 56)>)
      #scope: (Default)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:34/        z_e = self.pre_quantization_conv(z_e)/

#------------------------> 0
  %3(CNode_33) = call @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24(%2)
      : (<Tensor[Float32], (2, 64, 56, 56)>) -> (<null>)
      #scope: (Default)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:35/        embedding_loss, z_q, perplexity, _, _ = self.vector_quantization(/
  %4(embedding_loss) = S_Prim_getitem(%3, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:35/        embedding_loss, z_q, perplexity, _, _ = self.vector_quantization(/
  %5(z_q) = S_Prim_getitem(%3, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:35/        embedding_loss, z_q, perplexity, _, _ = self.vector_quantization(/
  %6(perplexity) = S_Prim_getitem(%3, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:35/        embedding_loss, z_q, perplexity, _, _ = self.vector_quantization(/
  %7(CNode_34) = S_Prim_MakeTuple(%4, %5, %6)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:38/        return embedding_loss, z_q, perplexity/
  Return(%7)
      : (<null>)
      #scope: (Default)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vqvae.py:38/        return embedding_loss, z_q, perplexity/
}
# Order:
#   1: @videogvt_models_vqvae_vqvae_VQVAE_construct_23:z_e{[0]: ValueNode<FuncGraph> videogvt_models_vqvae_encoder_Encoder_construct_31, [1]: param_x}
#   2: @videogvt_models_vqvae_vqvae_VQVAE_construct_23:z_e{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_32, [1]: z_e}
#   3: @videogvt_models_vqvae_vqvae_VQVAE_construct_23:CNode_33{[0]: ValueNode<FuncGraph> videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24, [1]: z_e}
#   4: @videogvt_models_vqvae_vqvae_VQVAE_construct_23:embedding_loss{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_33, [2]: ValueNode<Int64Imm> 0}
#   5: @videogvt_models_vqvae_vqvae_VQVAE_construct_23:z_q{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_33, [2]: ValueNode<Int64Imm> 1}
#   6: @videogvt_models_vqvae_vqvae_VQVAE_construct_23:perplexity{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_33, [2]: ValueNode<Int64Imm> 2}
#   7: @videogvt_models_vqvae_vqvae_VQVAE_construct_23:CNode_34{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: embedding_loss, [2]: z_q, [3]: perplexity}
#   8: @videogvt_models_vqvae_vqvae_VQVAE_construct_23:CNode_35{[0]: ValueNode<Primitive> Return, [1]: CNode_34}


subgraph attr:
subgraph instance: videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24 : 0x16bf90b0
# In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:26/    def construct(self, z):/
subgraph @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para9_z) {
  %1(CNode_36) = S_Prim_MakeTuple("input", "axis", "index", "src")
      : (<String, NoShape>, <String, NoShape>, <String, NoShape>, <String, NoShape>) -> (<Tuple[String*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:55/        min_encodings = ops.scatter(input=min_encodings, axis=1, index=min_encoding_indices, src=min_encoding_src)/
  %2(CNode_37) = getattr(%para9_z, "permute")
      : (<Tensor[Float32], (2, 64, 56, 56)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:42/        z = z.permute(0, 2, 3, 1)/
  %3(z) = %2(I64(0), I64(2), I64(3), I64(1))
      : (<Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:42/        z = z.permute(0, 2, 3, 1)/
  %4(CNode_38) = getattr(%3, "view")
      : (<Tensor[Float32], (2, 56, 56, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:43/        z_flattened = z.view(-1, self.e_dim)/
  %5(CNode_39) = S_Prim_negative(I64(1))
      : (<Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:43/        z_flattened = z.view(-1, self.e_dim)/
  %6(z_flattened) = %4(%5, I64(64))
      : (<Int64, NoShape>, <Int64, NoShape>) -> (<Tensor[Float32], (6272, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:43/        z_flattened = z.view(-1, self.e_dim)/
  %7(CNode_40) = getattr(%6, "pow")
      : (<Tensor[Float32], (6272, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:46/        d = ops.sum(z_flattened.pow(2), dim=1, keepdim=True) + \/
  %8(CNode_41) = %7(I64(2))
      : (<Int64, NoShape>) -> (<Tensor[Float32], (6272, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:46/        d = ops.sum(z_flattened.pow(2), dim=1, keepdim=True) + \/
  %9(CNode_42) = S_Prim_MakeTuple(%8)
      : (<Tensor[Float32], (6272, 64)>) -> (<Tuple[Tensor[Float32]], TupleShape((6272, 64))>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:46/        d = ops.sum(z_flattened.pow(2), dim=1, keepdim=True) + \/
  %10(CNode_43) = S_Prim_MakeTuple("dim", "keepdim")
      : (<String, NoShape>, <String, NoShape>) -> (<Tuple[String*2], TupleShape(NoShape, NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:46/        d = ops.sum(z_flattened.pow(2), dim=1, keepdim=True) + \/
  %11(CNode_44) = S_Prim_MakeTuple(I64(1), Bool(1))
      : (<Int64, NoShape>, <Bool, NoShape>) -> (<Tuple[Int64,Bool], TupleShape(NoShape, NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:46/        d = ops.sum(z_flattened.pow(2), dim=1, keepdim=True) + \/
  %12(CNode_45) = S_Prim_make_dict(%10, %11)
      : (<Tuple[String*2], TupleShape(NoShape, NoShape)>, <Tuple[Int64,Bool], TupleShape(NoShape, NoShape)>) -> (<Dictionary[[dim,keepdim,],[Int64,Bool]], NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:46/        d = ops.sum(z_flattened.pow(2), dim=1, keepdim=True) + \/
  %13(CNode_46) = UnpackCall_unpack_call(@sum_47, %9, %12)
      : (<Func, NoShape>, <Tuple[Tensor[Float32]], TupleShape((6272, 64))>, <Dictionary[[dim,keepdim,],[Int64,Bool]], NoShape>) -> (<Tensor[Float32], (6272, 1)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:46/        d = ops.sum(z_flattened.pow(2), dim=1, keepdim=True) + \/
  %14(CNode_48) = getattr(%para3_vector_quantization.embedding.embedding_table, "value")
      : (<Ref[Tensor[Float32]], (512, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %15(CNode_49) = %14()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %16(CNode_50) = getattr(%15, "pow")
      : (<Tensor[Float32], (512, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %17(CNode_51) = %16(I64(2))
      : (<Int64, NoShape>) -> (<Tensor[Float32], (512, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %18(CNode_52) = S_Prim_MakeTuple(%17)
      : (<Tensor[Float32], (512, 64)>) -> (<Tuple[Tensor[Float32]], TupleShape((512, 64))>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %19(CNode_53) = S_Prim_MakeTuple("dim")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %20(CNode_54) = S_Prim_MakeTuple(I64(1))
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %21(CNode_55) = S_Prim_make_dict(%19, %20)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[dim,],[Int64]], NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %22(CNode_56) = UnpackCall_unpack_call(@sum_47, %18, %21)
      : (<Func, NoShape>, <Tuple[Tensor[Float32]], TupleShape((512, 64))>, <Dictionary[[dim,],[Int64]], NoShape>) -> (<Tensor[Float32], (512)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %23(CNode_57) = S_Prim_add(%13, %22)
      : (<Tensor[Float32], (6272, 1)>, <Tensor[Float32], (512)>) -> (<Tensor[Float32], (6272, 512)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:46/        d = ops.sum(z_flattened.pow(2), dim=1, keepdim=True) + \/
  %24(CNode_58) = getattr(%para3_vector_quantization.embedding.embedding_table, "value")
      : (<Ref[Tensor[Float32]], (512, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:48/            ops.matmul(z_flattened, self.embedding.embedding_table.value().t())/
  %25(CNode_59) = %24()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:48/            ops.matmul(z_flattened, self.embedding.embedding_table.value().t())/
  %26(CNode_60) = getattr(%25, "t")
      : (<Tensor[Float32], (512, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:48/            ops.matmul(z_flattened, self.embedding.embedding_table.value().t())/
  %27(CNode_61) = %26()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:48/            ops.matmul(z_flattened, self.embedding.embedding_table.value().t())/
  %28(CNode_63) = call @matmul_62(%6, %27)
      : (<Tensor[Float32], (6272, 64)>, <Tensor[Float32], (64, 512)>) -> (<Tensor[Float32], (6272, 512)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:48/            ops.matmul(z_flattened, self.embedding.embedding_table.value().t())/
  %29(CNode_64) = S_Prim_mul(I64(2), %28)
      : (<Int64, NoShape>, <Tensor[Float32], (6272, 512)>) -> (<Tensor[Float32], (6272, 512)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  %30(d) = S_Prim_sub(%23, %29)
      : (<Tensor[Float32], (6272, 512)>, <Tensor[Float32], (6272, 512)>) -> (<Tensor[Float32], (6272, 512)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:46/        d = ops.sum(z_flattened.pow(2), dim=1, keepdim=True) + \/
  %31(CNode_65) = S_Prim_MakeTuple(%30)
      : (<Tensor[Float32], (6272, 512)>) -> (<Tuple[Tensor[Float32]], TupleShape((6272, 512))>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  %32(CNode_66) = S_Prim_MakeTuple("axis")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  %33(CNode_67) = S_Prim_MakeTuple(I64(1))
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  %34(CNode_68) = S_Prim_make_dict(%32, %33)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[axis,],[Int64]], NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  %35(CNode_69) = UnpackCall_unpack_call(@argmin_70, %31, %34)
      : (<Func, NoShape>, <Tuple[Tensor[Float32]], TupleShape((6272, 512))>, <Dictionary[[axis,],[Int64]], NoShape>) -> (<Tensor[Int32], (6272)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  %36(CNode_71) = getattr(%35, "unsqueeze")
      : (<Tensor[Int32], (6272)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  %37(min_encoding_indices) = %36(I64(1))
      : (<Int64, NoShape>) -> (<Tensor[Int32], (6272, 1)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  %38(CNode_72) = getattr(%37, "shape")
      : (<Tensor[Int32], (6272, 1)>, <String, NoShape>) -> (<Tuple[Int64*2], TupleShape(NoShape, NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:53/            (min_encoding_indices.shape[0], self.n_e))/
  %39(CNode_73) = S_Prim_getitem(%38, I64(0))
      : (<Tuple[Int64*2], TupleShape(NoShape, NoShape)>, <Int64, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:53/            (min_encoding_indices.shape[0], self.n_e))/
  %40(CNode_74) = S_Prim_MakeTuple(%39, I64(512))
      : (<Int64, NoShape>, <Int64, NoShape>) -> (<Tuple[Int64*2], TupleShape(NoShape, NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:53/            (min_encoding_indices.shape[0], self.n_e))/
  %41(min_encodings) = call @zeros_75(%40)
      : (<Tuple[Int64*2], TupleShape(NoShape, NoShape)>) -> (<Tensor[Float32], (6272, 512)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:52/        min_encodings = ops.zeros(/
  %42(CNode_76) = S_Prim_MakeTuple(%37)
      : (<Tensor[Int32], (6272, 1)>) -> (<Tuple[Tensor[Int32]], TupleShape((6272, 1))>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:54/        min_encoding_src = ops.ones_like(min_encoding_indices, dtype=min_encodings.dtype)/
  %43(CNode_77) = S_Prim_MakeTuple("dtype")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:54/        min_encoding_src = ops.ones_like(min_encoding_indices, dtype=min_encodings.dtype)/
  %44(CNode_78) = getattr(%41, "dtype")
      : (<Tensor[Float32], (6272, 512)>, <String, NoShape>) -> (<TypeType, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:54/        min_encoding_src = ops.ones_like(min_encoding_indices, dtype=min_encodings.dtype)/
  %45(CNode_79) = S_Prim_MakeTuple(%44)
      : (<TypeType, NoShape>) -> (<Tuple[TypeType], TupleShape(NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:54/        min_encoding_src = ops.ones_like(min_encoding_indices, dtype=min_encodings.dtype)/
  %46(CNode_80) = S_Prim_make_dict(%43, %45)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[TypeType], TupleShape(NoShape)>) -> (<Dictionary[[dtype,],[TypeType]], NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:54/        min_encoding_src = ops.ones_like(min_encoding_indices, dtype=min_encodings.dtype)/
  %47(min_encoding_src) = UnpackCall_unpack_call(@ones_like_81, %42, %46)
      : (<Func, NoShape>, <Tuple[Tensor[Int32]], TupleShape((6272, 1))>, <Dictionary[[dtype,],[TypeType]], NoShape>) -> (<Tensor[Float32], (6272, 1)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:54/        min_encoding_src = ops.ones_like(min_encoding_indices, dtype=min_encodings.dtype)/
  %48(CNode_82) = S_Prim_MakeTuple(%41, I64(1), %37, %47)
      : (<Tensor[Float32], (6272, 512)>, <Int64, NoShape>, <Tensor[Int32], (6272, 1)>, <Tensor[Float32], (6272, 1)>) -> (<Tuple[Tensor[Float32],Int64,Tensor[Int32],Tensor[Float32]], TupleShape((6272, 512), NoShape, (6272, 1), (6272, 1))>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:55/        min_encodings = ops.scatter(input=min_encodings, axis=1, index=min_encoding_indices, src=min_encoding_src)/
  %49(CNode_83) = S_Prim_make_dict(%1, %48)
      : (<Tuple[String*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>, <Tuple[Tensor[Float32],Int64,Tensor[Int32],Tensor[Float32]], TupleShape((6272, 512), NoShape, (6272, 1), (6272, 1))>) -> (<Dictionary[[input,axis,index,src,],[Tensor[Float32],Int64,Tensor[Int32],Tensor[Float32]]], NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:55/        min_encodings = ops.scatter(input=min_encodings, axis=1, index=min_encoding_indices, src=min_encoding_src)/
  %50(min_encodings) = UnpackCall_unpack_call(@scatter_84, %49)
      : (<Func, NoShape>, <Dictionary[[input,axis,index,src,],[Tensor[Float32],Int64,Tensor[Int32],Tensor[Float32]]], NoShape>) -> (<Tensor[Float32], (6272, 512)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:55/        min_encodings = ops.scatter(input=min_encodings, axis=1, index=min_encoding_indices, src=min_encoding_src)/
  %51(CNode_85) = getattr(%para3_vector_quantization.embedding.embedding_table, "value")
      : (<Ref[Tensor[Float32]], (512, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:59/        z_q = ops.matmul(min_encodings, self.embedding.embedding_table.value()).view(z.shape)/
  %52(CNode_86) = %51()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:59/        z_q = ops.matmul(min_encodings, self.embedding.embedding_table.value()).view(z.shape)/
  %53(CNode_87) = call @matmul_62(%50, %52)
      : (<Tensor[Float32], (6272, 512)>, <Tensor[Float32], (512, 64)>) -> (<Tensor[Float32], (6272, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:59/        z_q = ops.matmul(min_encodings, self.embedding.embedding_table.value()).view(z.shape)/
  %54(CNode_88) = getattr(%53, "view")
      : (<Tensor[Float32], (6272, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:59/        z_q = ops.matmul(min_encodings, self.embedding.embedding_table.value()).view(z.shape)/
  %55(CNode_89) = getattr(%3, "shape")
      : (<Tensor[Float32], (2, 56, 56, 64)>, <String, NoShape>) -> (<Tuple[Int64*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:59/        z_q = ops.matmul(min_encodings, self.embedding.embedding_table.value()).view(z.shape)/
  %56(z_q) = %54(%55)
      : (<Tuple[Int64*4], TupleShape(NoShape, NoShape, NoShape, NoShape)>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:59/        z_q = ops.matmul(min_encodings, self.embedding.embedding_table.value()).view(z.shape)/
  %57(CNode_91) = call @stop_gradient_90(%56)
      : (<Tensor[Float32], (2, 56, 56, 64)>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:62/        loss = ops.mean((ops.stop_gradient(z_q)-z).pow(2)) + self.beta * \/
  %58(CNode_92) = S_Prim_sub(%57, %3)
      : (<Tensor[Float32], (2, 56, 56, 64)>, <Tensor[Float32], (2, 56, 56, 64)>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:62/        loss = ops.mean((ops.stop_gradient(z_q)-z).pow(2)) + self.beta * \/
  %59(CNode_93) = getattr(%58, "pow")
      : (<Tensor[Float32], (2, 56, 56, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:62/        loss = ops.mean((ops.stop_gradient(z_q)-z).pow(2)) + self.beta * \/
  %60(CNode_94) = %59(I64(2))
      : (<Int64, NoShape>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:62/        loss = ops.mean((ops.stop_gradient(z_q)-z).pow(2)) + self.beta * \/
  %61(CNode_96) = call @mean_95(%60)
      : (<Tensor[Float32], (2, 56, 56, 64)>) -> (<Tensor[Float32], ()>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:62/        loss = ops.mean((ops.stop_gradient(z_q)-z).pow(2)) + self.beta * \/
  %62(CNode_97) = call @stop_gradient_90(%3)
      : (<Tensor[Float32], (2, 56, 56, 64)>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:63/            ops.mean((z_q - ops.stop_gradient(z)).pow(2))/
  %63(CNode_98) = S_Prim_sub(%56, %62)
      : (<Tensor[Float32], (2, 56, 56, 64)>, <Tensor[Float32], (2, 56, 56, 64)>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:63/            ops.mean((z_q - ops.stop_gradient(z)).pow(2))/
  %64(CNode_99) = getattr(%63, "pow")
      : (<Tensor[Float32], (2, 56, 56, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:63/            ops.mean((z_q - ops.stop_gradient(z)).pow(2))/
  %65(CNode_100) = %64(I64(2))
      : (<Int64, NoShape>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:63/            ops.mean((z_q - ops.stop_gradient(z)).pow(2))/
  %66(CNode_101) = call @mean_95(%65)
      : (<Tensor[Float32], (2, 56, 56, 64)>) -> (<Tensor[Float32], ()>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:63/            ops.mean((z_q - ops.stop_gradient(z)).pow(2))/
  %67(CNode_102) = S_Prim_mul(F32(0.25), %66)
      : (<Float32, NoShape>, <Tensor[Float32], ()>) -> (<Tensor[Float32], ()>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:62/        loss = ops.mean((ops.stop_gradient(z_q)-z).pow(2)) + self.beta * \/
  %68(loss) = S_Prim_add(%61, %67)
      : (<Tensor[Float32], ()>, <Tensor[Float32], ()>) -> (<Tensor[Float32], ()>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:62/        loss = ops.mean((ops.stop_gradient(z_q)-z).pow(2)) + self.beta * \/
  %69(CNode_103) = S_Prim_sub(%56, %3)
      : (<Tensor[Float32], (2, 56, 56, 64)>, <Tensor[Float32], (2, 56, 56, 64)>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:66/        z_q = z + ops.stop_gradient(z_q - z)/
  %70(CNode_104) = call @stop_gradient_90(%69)
      : (<Tensor[Float32], (2, 56, 56, 64)>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:66/        z_q = z + ops.stop_gradient(z_q - z)/
  %71(z_q) = S_Prim_add(%3, %70)
      : (<Tensor[Float32], (2, 56, 56, 64)>, <Tensor[Float32], (2, 56, 56, 64)>) -> (<Tensor[Float32], (2, 56, 56, 64)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:66/        z_q = z + ops.stop_gradient(z_q - z)/
  %72(CNode_105) = getattr(%71, "permute")
      : (<Tensor[Float32], (2, 56, 56, 64)>, <String, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:73/        z_q = z_q.permute(0, 3, 1, 2)/
  %73(z_q) = %72(I64(0), I64(3), I64(1), I64(2))
      : (<Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>, <Int64, NoShape>) -> (<Tensor[Float32], (2, 64, 56, 56)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:73/        z_q = z_q.permute(0, 3, 1, 2)/
  %74(CNode_106) = S_Prim_MakeTuple(%50)
      : (<Tensor[Float32], (6272, 512)>) -> (<Tuple[Tensor[Float32]], TupleShape((6272, 512))>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/
  %75(CNode_107) = S_Prim_MakeTuple("dim")
      : (<String, NoShape>) -> (<Tuple[String], TupleShape(NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/
  %76(CNode_108) = S_Prim_MakeTuple(I64(0))
      : (<Int64, NoShape>) -> (<Tuple[Int64], TupleShape(NoShape)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/
  %77(CNode_109) = S_Prim_make_dict(%75, %76)
      : (<Tuple[String], TupleShape(NoShape)>, <Tuple[Int64], TupleShape(NoShape)>) -> (<Dictionary[[dim,],[Int64]], NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/

#------------------------> 1
  %78(e_mean) = UnpackCall_unpack_call(@mean_95, %74, %77)
      : (<Func, NoShape>, <Tuple[Tensor[Float32]], TupleShape((6272, 512))>, <Dictionary[[dim,],[Int64]], NoShape>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/
  %79(CNode_110) = S_Prim_add(%78, F32(1e-10))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:70/        perplexity = ops.exp(-ops.sum(e_mean * ops.log(e_mean + 1e-10)))/
  %80(CNode_112) = call @log_111(%79)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:70/        perplexity = ops.exp(-ops.sum(e_mean * ops.log(e_mean + 1e-10)))/
  %81(CNode_113) = S_Prim_mul(%78, %80)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:70/        perplexity = ops.exp(-ops.sum(e_mean * ops.log(e_mean + 1e-10)))/
  %82(CNode_114) = call @sum_47(%81)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:70/        perplexity = ops.exp(-ops.sum(e_mean * ops.log(e_mean + 1e-10)))/
  %83(CNode_115) = S_Prim_negative(%82)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:70/        perplexity = ops.exp(-ops.sum(e_mean * ops.log(e_mean + 1e-10)))/
  %84(perplexity) = call @exp_116(%83)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:70/        perplexity = ops.exp(-ops.sum(e_mean * ops.log(e_mean + 1e-10)))/
  %85(CNode_117) = S_Prim_MakeTuple(%68, %73, %84, %50, %37)
      : (<Tensor[Float32], ()>, <Tensor[Float32], (2, 64, 56, 56)>, <null>, <Tensor[Float32], (6272, 512)>, <Tensor[Int32], (6272, 1)>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:75/        return loss, z_q, perplexity, min_encodings, min_encoding_indices/
  Return(%85)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:75/        return loss, z_q, perplexity, min_encodings, min_encoding_indices/
}
# Order:
#   1: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_37{[0]: ValueNode<Primitive> getattr, [1]: param_z, [2]: ValueNode<StringImm> permute}
#   2: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:z{[0]: CNode_37, [1]: ValueNode<Int64Imm> 0, [2]: ValueNode<Int64Imm> 2, [3]: ValueNode<Int64Imm> 3, [4]: ValueNode<Int64Imm> 1}
#   3: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_38{[0]: ValueNode<Primitive> getattr, [1]: z, [2]: ValueNode<StringImm> view}
#   4: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_39{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 1}
#   5: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:z_flattened{[0]: CNode_38, [1]: CNode_39, [2]: ValueNode<Int64Imm> 64}
#   6: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_40{[0]: ValueNode<Primitive> getattr, [1]: z_flattened, [2]: ValueNode<StringImm> pow}
#   7: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_41{[0]: CNode_40, [1]: ValueNode<Int64Imm> 2}
#   8: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_42{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_41}
#   9: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_43{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> dim, [2]: ValueNode<StringImm> keepdim}
#  10: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_44{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<Int64Imm> 1, [2]: ValueNode<BoolImm> true}
#  11: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_45{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_43, [2]: CNode_44}
#  12: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_46{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.118, [1]: ValueNode<FuncGraph> sum_47, [2]: CNode_42, [3]: CNode_45}
#  13: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_48{[0]: ValueNode<Primitive> getattr, [1]: param_vector_quantization.embedding.embedding_table, [2]: ValueNode<StringImm> value}
#  14: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_49{[0]: CNode_48}
#  15: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_50{[0]: ValueNode<Primitive> getattr, [1]: CNode_49, [2]: ValueNode<StringImm> pow}
#  16: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_51{[0]: CNode_50, [1]: ValueNode<Int64Imm> 2}
#  17: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_52{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_51}
#  18: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_53{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> dim}
#  19: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_54{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<Int64Imm> 1}
#  20: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_55{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_53, [2]: CNode_54}
#  21: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_56{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.119, [1]: ValueNode<FuncGraph> sum_47, [2]: CNode_52, [3]: CNode_55}
#  22: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_57{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: CNode_46, [2]: CNode_56}
#  23: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_58{[0]: ValueNode<Primitive> getattr, [1]: param_vector_quantization.embedding.embedding_table, [2]: ValueNode<StringImm> value}
#  24: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_59{[0]: CNode_58}
#  25: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_60{[0]: ValueNode<Primitive> getattr, [1]: CNode_59, [2]: ValueNode<StringImm> t}
#  26: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_61{[0]: CNode_60}
#  27: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_63{[0]: ValueNode<FuncGraph> matmul_62, [1]: z_flattened, [2]: CNode_61}
#  28: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_64{[0]: ValueNode<DoSignaturePrimitive> S_Prim_mul, [1]: ValueNode<Int64Imm> 2, [2]: CNode_63}
#  29: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:d{[0]: ValueNode<DoSignaturePrimitive> S_Prim_sub, [1]: CNode_57, [2]: CNode_64}
#  30: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_65{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: d}
#  31: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_66{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> axis}
#  32: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_67{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<Int64Imm> 1}
#  33: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_68{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_66, [2]: CNode_67}
#  34: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_69{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.120, [1]: ValueNode<FuncGraph> argmin_70, [2]: CNode_65, [3]: CNode_68}
#  35: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_71{[0]: ValueNode<Primitive> getattr, [1]: CNode_69, [2]: ValueNode<StringImm> unsqueeze}
#  36: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:min_encoding_indices{[0]: CNode_71, [1]: ValueNode<Int64Imm> 1}
#  37: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_72{[0]: ValueNode<Primitive> getattr, [1]: min_encoding_indices, [2]: ValueNode<StringImm> shape}
#  38: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_73{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_72, [2]: ValueNode<Int64Imm> 0}
#  39: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_74{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_73, [2]: ValueNode<Int64Imm> 512}
#  40: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:min_encodings{[0]: ValueNode<FuncGraph> zeros_75, [1]: CNode_74}
#  41: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_76{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: min_encoding_indices}
#  42: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_78{[0]: ValueNode<Primitive> getattr, [1]: min_encodings, [2]: ValueNode<StringImm> dtype}
#  43: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_77{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> dtype}
#  44: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_79{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_78}
#  45: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_80{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_77, [2]: CNode_79}
#  46: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:min_encoding_src{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.121, [1]: ValueNode<FuncGraph> ones_like_81, [2]: CNode_76, [3]: CNode_80}
#  47: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_36{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> input, [2]: ValueNode<StringImm> axis, [3]: ValueNode<StringImm> index, [4]: ValueNode<StringImm> src}
#  48: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_82{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: min_encodings, [2]: ValueNode<Int64Imm> 1, [3]: min_encoding_indices, [4]: min_encoding_src}
#  49: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_83{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_36, [2]: CNode_82}
#  50: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:min_encodings{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.122, [1]: ValueNode<FuncGraph> scatter_84, [2]: CNode_83}
#  51: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_85{[0]: ValueNode<Primitive> getattr, [1]: param_vector_quantization.embedding.embedding_table, [2]: ValueNode<StringImm> value}
#  52: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_86{[0]: CNode_85}
#  53: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_87{[0]: ValueNode<FuncGraph> matmul_62, [1]: min_encodings, [2]: CNode_86}
#  54: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_88{[0]: ValueNode<Primitive> getattr, [1]: CNode_87, [2]: ValueNode<StringImm> view}
#  55: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_89{[0]: ValueNode<Primitive> getattr, [1]: z, [2]: ValueNode<StringImm> shape}
#  56: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:z_q{[0]: CNode_88, [1]: CNode_89}
#  57: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_91{[0]: ValueNode<FuncGraph> stop_gradient_90, [1]: z_q}
#  58: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_92{[0]: ValueNode<DoSignaturePrimitive> S_Prim_sub, [1]: CNode_91, [2]: z}
#  59: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_93{[0]: ValueNode<Primitive> getattr, [1]: CNode_92, [2]: ValueNode<StringImm> pow}
#  60: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_94{[0]: CNode_93, [1]: ValueNode<Int64Imm> 2}
#  61: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_96{[0]: ValueNode<FuncGraph> mean_95, [1]: CNode_94}
#  62: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_97{[0]: ValueNode<FuncGraph> stop_gradient_90, [1]: z}
#  63: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_98{[0]: ValueNode<DoSignaturePrimitive> S_Prim_sub, [1]: z_q, [2]: CNode_97}
#  64: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_99{[0]: ValueNode<Primitive> getattr, [1]: CNode_98, [2]: ValueNode<StringImm> pow}
#  65: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_100{[0]: CNode_99, [1]: ValueNode<Int64Imm> 2}
#  66: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_101{[0]: ValueNode<FuncGraph> mean_95, [1]: CNode_100}
#  67: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_102{[0]: ValueNode<DoSignaturePrimitive> S_Prim_mul, [1]: ValueNode<FP32Imm> 0.25, [2]: CNode_101}
#  68: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:loss{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: CNode_96, [2]: CNode_102}
#  69: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_103{[0]: ValueNode<DoSignaturePrimitive> S_Prim_sub, [1]: z_q, [2]: z}
#  70: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_104{[0]: ValueNode<FuncGraph> stop_gradient_90, [1]: CNode_103}
#  71: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:z_q{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: z, [2]: CNode_104}
#  72: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_106{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: min_encodings}
#  73: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_107{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> dim}
#  74: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_108{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<Int64Imm> 0}
#  75: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_109{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_107, [2]: CNode_108}
#  76: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:e_mean{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.123, [1]: ValueNode<FuncGraph> mean_95, [2]: CNode_106, [3]: CNode_109}
#  77: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_110{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: e_mean, [2]: ValueNode<FP32Imm> 1e-10}
#  78: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_112{[0]: ValueNode<FuncGraph> log_111, [1]: CNode_110}
#  79: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_113{[0]: ValueNode<DoSignaturePrimitive> S_Prim_mul, [1]: e_mean, [2]: CNode_112}
#  80: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_114{[0]: ValueNode<FuncGraph> sum_47, [1]: CNode_113}
#  81: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_115{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: CNode_114}
#  82: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:perplexity{[0]: ValueNode<FuncGraph> exp_116, [1]: CNode_115}
#  83: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_105{[0]: ValueNode<Primitive> getattr, [1]: z_q, [2]: ValueNode<StringImm> permute}
#  84: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:z_q{[0]: CNode_105, [1]: ValueNode<Int64Imm> 0, [2]: ValueNode<Int64Imm> 3, [3]: ValueNode<Int64Imm> 1, [4]: ValueNode<Int64Imm> 2}
#  85: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_117{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: loss, [2]: z_q, [3]: perplexity, [4]: min_encodings, [5]: min_encoding_indices}
#  86: @videogvt_models_vqvae_vector_quantizer_VectorQuantizer_construct_24:CNode_124{[0]: ValueNode<Primitive> Return, [1]: CNode_117}


subgraph attr:
core : 1
subgraph instance: UnpackCall_25 : 0x17527770
# In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/
subgraph @UnpackCall_25(%para10_, %para11_, %para12_) {
  %1(e_mean) = TupleGetItem(%para11_27, I64(0))
      : (<Tuple[Tensor[Float32]], TupleShape((6272, 512))>, <Int64, NoShape>) -> (<Tensor[Float32], (6272, 512)>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/
  %2(e_mean) = dict_getitem(%para12_28, "dim")
      : (<Dictionary[[dim,],[Int64]], NoShape>, <String, NoShape>) -> (<Int64, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/
  %3(e_mean) = make_keyword_arg("dim", %2)
      : (<String, NoShape>, <Int64, NoShape>) -> (<Keyword[key : dim, value : Int64], NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/

#------------------------> 2
  %4(e_mean) = %para10_26(%1, %3)
      : (<Tensor[Float32], (6272, 512)>, <Keyword[key : dim, value : Int64], NoShape>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/
  Return(%4)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:69/        e_mean = ops.mean(min_encodings, dim=0)/
}
# Order:
#   1: @UnpackCall_25:e_mean{[0]: param_26, [1]: e_mean, [2]: e_mean}
#   2: @UnpackCall_25:e_mean{[0]: ValueNode<Primitive> Return, [1]: e_mean}


subgraph attr:
subgraph instance: mean_29 : 0x17526a50
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @mean_29(%para13_x, %para14_axis) {
  %1(CNode_125) = S_Prim_is_(%para14_axis, None)
      : (<Keyword[key : dim, value : Int64], NoShape>, <None, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %2(CNode_126) = Cond(%1, Bool(0))
      : (<Bool, NoShape>, <Bool, NoShape>) -> (<Bool, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %3(CNode_127) = Switch(%2, @mean_128, @mean_129)
      : (<Bool, NoShape>, <Func, NoShape>, <Func, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %4(CNode_130) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/

#------------------------> 3
  %5(CNode_132) = call @mean_131(%4)
      : (<Keyword[key : dim, value : Int64], NoShape>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:63/            ops.mean((z_q - ops.stop_gradient(z)).pow(2))/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
}
# Order:
#   1: @mean_29:CNode_125{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_, [1]: param_axis, [2]: ValueNode<None> None}
#   2: @mean_29:CNode_126{[0]: ValueNode<Primitive> Cond, [1]: CNode_125, [2]: ValueNode<BoolImm> false}
#   3: @mean_29:CNode_127{[0]: ValueNode<Primitive> Switch, [1]: CNode_126, [2]: ValueNode<FuncGraph> mean_128, [3]: ValueNode<FuncGraph> mean_129}
#   4: @mean_29:CNode_130{[0]: CNode_127}
#   5: @mean_29:CNode_132{[0]: ValueNode<FuncGraph> mean_131, [1]: CNode_130}
#   6: @mean_29:CNode_133{[0]: ValueNode<Primitive> Return, [1]: CNode_132}


subgraph attr:
after_block : 1
subgraph instance: mean_30 : 0x1752d0e0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @mean_30 parent: [subgraph @mean_29](%para15_) {
  %1(CNode_135) = call @_get_cache_prim_134(ClassType)
      : (<Func, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
  %2(CNode_136) = %1(Bool(0))
      : (<Bool, NoShape>) -> (<Func, NoShape>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/

#------------------------> 4
  %3(CNode_137) = %2(%para13_x, %para15_axis)
      : (<Tensor[Float32], (6272, 512)>, <Keyword[key : dim, value : Int64], NoShape>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
  Return(%3)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
}
# Order:
#   1: @mean_30:CNode_135{[0]: ValueNode<FuncGraph> _get_cache_prim_134, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.ReduceMean'}
#   2: @mean_30:CNode_136{[0]: CNode_135, [1]: ValueNode<BoolImm> false}
#   3: @mean_30:CNode_137{[0]: CNode_136, [1]: param_x, [2]: param_axis}
#   4: @mean_30:CNode_138{[0]: ValueNode<Primitive> Return, [1]: CNode_137}


# ===============================================================================================
# The total of function graphs in evaluation stack: 5/6 (Ignored 1 internal frames).
# ===============================================================================================


# ===============================================================================================
# The rest function graphs are the following:
# ===============================================================================================
subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_32 : 0x16a72a60
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_32 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para16_x) {
  %1(CNode_140) = call @mindspore_nn_layer_conv_Conv2d_construct_139()
      #scope: (Default/pre_quantization_conv-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/pre_quantization_conv-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_32:output{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Conv2D, [1]: param_x, [2]: param_pre_quantization_conv.weight}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_32:CNode_140{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_139}
#   3: @mindspore_nn_layer_conv_Conv2d_construct_32:CNode_141{[0]: ValueNode<Primitive> Return, [1]: CNode_140}


subgraph attr:
subgraph instance: videogvt_models_vqvae_encoder_Encoder_construct_31 : 0x16afb760
# In file /disk3/katekong/magvit/videogvt/models/vqvae/encoder.py:41/    def construct(self, x):/
subgraph @videogvt_models_vqvae_encoder_Encoder_construct_31 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para17_x) {
  %1(CNode_143) = call @mindspore_nn_layer_container_SequentialCell_construct_142(%para17_x)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/encoder.py:42/        return self.conv_stack(x)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/encoder.py:42/        return self.conv_stack(x)/
}
# Order:
#   1: @videogvt_models_vqvae_encoder_Encoder_construct_31:CNode_143{[0]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_142, [1]: param_x}
#   2: @videogvt_models_vqvae_encoder_Encoder_construct_31:CNode_144{[0]: ValueNode<Primitive> Return, [1]: CNode_143}


subgraph attr:
subgraph instance: argmin_70 : 0x16d9e2b0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @argmin_70(%para18_input, %para19_axis, %para20_keepdims) {
  %1(CNode_145) = getattr(%para18_input, "shape")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  %2(CNode_146) = S_Prim_logical_not(%1)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  %3(CNode_147) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  %4(CNode_148) = Switch(%3, @argmin_149, @argmin_150)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  %5(CNode_151) = %4()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
}
# Order:
#   1: @argmin_70:CNode_145{[0]: ValueNode<Primitive> getattr, [1]: param_input, [2]: ValueNode<StringImm> shape}
#   2: @argmin_70:CNode_146{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_145}
#   3: @argmin_70:CNode_147{[0]: ValueNode<Primitive> Cond, [1]: CNode_146, [2]: ValueNode<BoolImm> false}
#   4: @argmin_70:CNode_148{[0]: ValueNode<Primitive> Switch, [1]: CNode_147, [2]: ValueNode<FuncGraph> argmin_149, [3]: ValueNode<FuncGraph> argmin_150}
#   5: @argmin_70:CNode_151{[0]: CNode_148}
#   6: @argmin_70:CNode_152{[0]: ValueNode<Primitive> Return, [1]: CNode_151}


subgraph attr:
subgraph instance: matmul_62 : 0x16dd9100
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_62(%para21_input, %para22_other) {
  %1(CNode_153) = S_Prim_isinstance(%para21_input, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %2(CNode_154) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %3(CNode_155) = Switch(%2, @matmul_156, @matmul_157)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %4(CNode_158) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %5(CNode_159) = S_Prim_logical_not(%4)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %6(CNode_160) = Cond(%5, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %7(CNode_161) = Switch(%6, @matmul_162, @matmul_163)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  %8(CNode_164) = %7()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  Return(%8)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
}
# Order:
#   1: @matmul_62:CNode_153{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_input, [2]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor'}
#   2: @matmul_62:CNode_154{[0]: ValueNode<Primitive> Cond, [1]: CNode_153, [2]: ValueNode<BoolImm> false}
#   3: @matmul_62:CNode_155{[0]: ValueNode<Primitive> Switch, [1]: CNode_154, [2]: ValueNode<FuncGraph> matmul_156, [3]: ValueNode<FuncGraph> matmul_157}
#   4: @matmul_62:CNode_158{[0]: CNode_155}
#   5: @matmul_62:CNode_159{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_158}
#   6: @matmul_62:CNode_160{[0]: ValueNode<Primitive> Cond, [1]: CNode_159, [2]: ValueNode<BoolImm> false}
#   7: @matmul_62:CNode_161{[0]: ValueNode<Primitive> Switch, [1]: CNode_160, [2]: ValueNode<FuncGraph> matmul_162, [3]: ValueNode<FuncGraph> matmul_163}
#   8: @matmul_62:CNode_164{[0]: CNode_161}
#   9: @matmul_62:CNode_165{[0]: ValueNode<Primitive> Return, [1]: CNode_164}


subgraph attr:
subgraph instance: sum_47 : 0x16db2a50
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @sum_47(%para23_input, %para24_dim, %para25_keepdim, %para26_dtype) {
  %1(CNode_166) = S_Prim_isinstance(%para23_input, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  %2(CNode_167) = S_Prim_logical_not(%1)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  %3(CNode_168) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  %4(CNode_169) = Switch(%3, @sum_170, @sum_171)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  %5(CNode_172) = %4()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
}
# Order:
#   1: @sum_47:CNode_166{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_input, [2]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor'}
#   2: @sum_47:CNode_167{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_166}
#   3: @sum_47:CNode_168{[0]: ValueNode<Primitive> Cond, [1]: CNode_167, [2]: ValueNode<BoolImm> false}
#   4: @sum_47:CNode_169{[0]: ValueNode<Primitive> Switch, [1]: CNode_168, [2]: ValueNode<FuncGraph> sum_170, [3]: ValueNode<FuncGraph> sum_171}
#   5: @sum_47:CNode_172{[0]: CNode_169}
#   6: @sum_47:CNode_173{[0]: ValueNode<Primitive> Return, [1]: CNode_172}


subgraph attr:
subgraph instance: scatter_84 : 0x16b2f760
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4007/def scatter(input, axis, index, src):/
subgraph @scatter_84(%para27_input, %para28_axis, %para29_index, %para30_src) {
  %1(CNode_174) = S_Prim_MakeTuple("input_x", "indices", "updates", "axis")
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4065/    return ops.tensor_scatter_elements(input_x=input, indices=index, updates=src, axis=axis)/
  %2(CNode_175) = S_Prim_MakeTuple(%para27_input, %para29_index, %para30_src, %para28_axis)
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4065/    return ops.tensor_scatter_elements(input_x=input, indices=index, updates=src, axis=axis)/
  %3(CNode_176) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4065/    return ops.tensor_scatter_elements(input_x=input, indices=index, updates=src, axis=axis)/
  %4(CNode_177) = UnpackCall_unpack_call(@tensor_scatter_elements_178, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4065/    return ops.tensor_scatter_elements(input_x=input, indices=index, updates=src, axis=axis)/
  Return(%4)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4065/    return ops.tensor_scatter_elements(input_x=input, indices=index, updates=src, axis=axis)/
}
# Order:
#   1: @scatter_84:CNode_174{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> input_x, [2]: ValueNode<StringImm> indices, [3]: ValueNode<StringImm> updates, [4]: ValueNode<StringImm> axis}
#   2: @scatter_84:CNode_175{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_input, [2]: param_index, [3]: param_src, [4]: param_axis}
#   3: @scatter_84:CNode_176{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_174, [2]: CNode_175}
#   4: @scatter_84:CNode_177{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.179, [1]: ValueNode<FuncGraph> tensor_scatter_elements_178, [2]: CNode_176}
#   5: @scatter_84:CNode_180{[0]: ValueNode<Primitive> Return, [1]: CNode_177}


subgraph attr:
subgraph instance: ones_like_81 : 0x16bdb290
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:967/def ones_like(input, *, dtype=None):/
subgraph @ones_like_81(%para31_input, %para32_dtype) {
  %1(CNode_181) = call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:996/    ones_like_op = _get_cache_prim(P.OnesLike)()/
  %2(ones_like_op) = %1()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:996/    ones_like_op = _get_cache_prim(P.OnesLike)()/
  %3(output) = %2(%para31_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:997/    output = ones_like_op(input)/
  %4(CNode_182) = S_Prim_is_(%para32_dtype, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:998/    _dtype = input.dtype if dtype is None else dtype/
  %5(CNode_183) = Cond(%4, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:998/    _dtype = input.dtype if dtype is None else dtype/
  %6(CNode_184) = Switch(%5, @ones_like_185, @ones_like_186)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:998/    _dtype = input.dtype if dtype is None else dtype/
  %7(_dtype) = %6()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:998/    _dtype = input.dtype if dtype is None else dtype/
  %8(output) = S_Prim_Cast[output_names: ["output"], input_names: ["x", "dst_type"], SrcT: I32, DstT: F32](%3, %7)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:999/    output = cast_(output, _dtype)/
  Return(%8)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1000/    return output/
}
# Order:
#   1: @ones_like_81:CNode_181{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.array_ops.OnesLike'}
#   2: @ones_like_81:ones_like_op{[0]: CNode_181}
#   3: @ones_like_81:output{[0]: ones_like_op, [1]: param_input}
#   4: @ones_like_81:CNode_182{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_, [1]: param_dtype, [2]: ValueNode<None> None}
#   5: @ones_like_81:CNode_183{[0]: ValueNode<Primitive> Cond, [1]: CNode_182, [2]: ValueNode<BoolImm> false}
#   6: @ones_like_81:CNode_184{[0]: ValueNode<Primitive> Switch, [1]: CNode_183, [2]: ValueNode<FuncGraph> ones_like_185, [3]: ValueNode<FuncGraph> ones_like_186}
#   7: @ones_like_81:_dtype{[0]: CNode_184}
#   8: @ones_like_81:output{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Cast, [1]: output, [2]: _dtype}
#   9: @ones_like_81:CNode_187{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
subgraph instance: zeros_75 : 0x16a50ee0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @zeros_75(%para33_size, %para34_dtype) {
  %1(CNode_188) = S_Prim_isinstance(%para33_size, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
  %2(CNode_189) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
  %3(CNode_190) = Switch(%2, @zeros_191, @zeros_192)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
  %4(CNode_193) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
  %5(CNode_195) = call @zeros_194(%4)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:52/        min_encodings = ops.zeros(/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1034/    if isinstance(size, int):/
}
# Order:
#   1: @zeros_75:CNode_196{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.array_ops.FillV2'}
#   2: @zeros_75:zero_op{[0]: CNode_196}
#   3: @zeros_75:CNode_197{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_, [1]: param_dtype, [2]: ValueNode<None> None}
#   4: @zeros_75:CNode_198{[0]: ValueNode<Primitive> Cond, [1]: CNode_197, [2]: ValueNode<BoolImm> false}
#   5: @zeros_75:CNode_199{[0]: ValueNode<Primitive> Switch, [1]: CNode_198, [2]: ValueNode<FuncGraph> zeros_200, [3]: ValueNode<FuncGraph> zeros_201}
#   6: @zeros_75:_dtype{[0]: CNode_199}
#   7: @zeros_75:CNode_202{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> _dtype}
#   8: @zeros_75:CNode_203{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: _dtype}
#   9: @zeros_75:CNode_204{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_202, [2]: CNode_203}
#  10: @zeros_75:value{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'Tensor(0, _dtype)', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'_get_cache_prim': <function _get_cache_prim at 0x7f933db57d30>, 'P': <module 'mindspore.ops.operations' from '/disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/operations/__init__.py'>, 'mstype': <module 'mindspore.common.dtype' from '/disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/common/dtype.py'>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>}), [3]: CNode_204}
#  11: @zeros_75:CNode_188{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_size, [2]: ValueNode<ClassType> class 'int'}
#  12: @zeros_75:CNode_189{[0]: ValueNode<Primitive> Cond, [1]: CNode_188, [2]: ValueNode<BoolImm> false}
#  13: @zeros_75:CNode_190{[0]: ValueNode<Primitive> Switch, [1]: CNode_189, [2]: ValueNode<FuncGraph> zeros_191, [3]: ValueNode<FuncGraph> zeros_192}
#  14: @zeros_75:CNode_193{[0]: CNode_190}
#  15: @zeros_75:CNode_195{[0]: ValueNode<FuncGraph> zeros_194, [1]: CNode_193}
#  16: @zeros_75:CNode_205{[0]: ValueNode<Primitive> Return, [1]: CNode_195}


subgraph attr:
subgraph instance: exp_116 : 0x16b46c00
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1368/def exp(input):/
subgraph @exp_116(%para35_input) {
  %1(CNode_206) = S_Prim_Exp[output_names: ["y"], shift: F32(0), scale: F32(1), input_names: ["x"], base: F32(-1)](%para35_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1397/    return tensor_exp(input)/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1397/    return tensor_exp(input)/
}
# Order:
#   1: @exp_116:CNode_206{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Exp, [1]: param_input}
#   2: @exp_116:CNode_207{[0]: ValueNode<Primitive> Return, [1]: CNode_206}


subgraph attr:
subgraph instance: log_111 : 0x16b01120
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1432/def log(input):/
subgraph @log_111(%para36_input) {
  %1(CNode_208) = S_Prim_Log[output_names: ["y"], shift: F32(0), scale: F32(1), cust_aicpu: "Log", input_names: ["x"], base: F32(-1)](%para36_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1464/    return log_(input)/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:1464/    return log_(input)/
}
# Order:
#   1: @log_111:CNode_208{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Log, [1]: param_input}
#   2: @log_111:CNode_209{[0]: ValueNode<Primitive> Return, [1]: CNode_208}


subgraph attr:
subgraph instance: mean_95 : 0x16e0ad40
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @mean_95(%para37_x, %para38_axis, %para39_keep_dims) {
  %1(CNode_125) = S_Prim_is_(%para38_axis, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %2(CNode_126) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %3(CNode_127) = Switch(%2, @mean_210, @mean_211)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %4(CNode_130) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
  %5(CNode_132) = call @mean_212(%4)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:63/            ops.mean((z_q - ops.stop_gradient(z)).pow(2))/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
}
# Order:
#   1: @mean_95:CNode_125{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_, [1]: param_axis, [2]: ValueNode<None> None}
#   2: @mean_95:CNode_126{[0]: ValueNode<Primitive> Cond, [1]: CNode_125, [2]: ValueNode<BoolImm> false}
#   3: @mean_95:CNode_127{[0]: ValueNode<Primitive> Switch, [1]: CNode_126, [2]: ValueNode<FuncGraph> mean_210, [3]: ValueNode<FuncGraph> mean_211}
#   4: @mean_95:CNode_130{[0]: CNode_127}
#   5: @mean_95:CNode_132{[0]: ValueNode<FuncGraph> mean_212, [1]: CNode_130}
#   6: @mean_95:CNode_133{[0]: ValueNode<Primitive> Return, [1]: CNode_132}


subgraph attr:
subgraph instance: stop_gradient_90 : 0x16bda4e0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/grad/grad_func.py:1367/def stop_gradient(value):/
subgraph @stop_gradient_90(%para40_value) {
  %1(CNode_213) = ClassType()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/grad/grad_func.py:1401/    return P.StopGradient()(value)/
  %2(CNode_214) = %1(%para40_value)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/grad/grad_func.py:1401/    return P.StopGradient()(value)/
  Return(%2)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/grad/grad_func.py:1401/    return P.StopGradient()(value)/
}
# Order:
#   1: @stop_gradient_90:CNode_213{[0]: ValueNode<ClassType> class 'mindspore.ops.operations.other_ops.StopGradient'}
#   2: @stop_gradient_90:CNode_214{[0]: CNode_213, [1]: param_value}
#   3: @stop_gradient_90:CNode_215{[0]: ValueNode<Primitive> Return, [1]: CNode_214}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_139 : 0x16aa46f0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_139 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_32]() {
  %1(CNode_217) = call @mindspore_nn_layer_conv_Conv2d_construct_216()
      #scope: (Default/pre_quantization_conv-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/pre_quantization_conv-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_139:CNode_217{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_216}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_139:CNode_218{[0]: ValueNode<Primitive> Return, [1]: CNode_217}


subgraph attr:
subgraph instance: mindspore_nn_layer_container_SequentialCell_construct_142 : 0x16c4cec0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
subgraph @mindspore_nn_layer_container_SequentialCell_construct_142 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para41_input_data) {
  %1(CNode_220) = call @mindspore_nn_layer_container_SequentialCell_construct_219(I64(0), %para41_input_data)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
}
# Order:
#   1: @mindspore_nn_layer_container_SequentialCell_construct_142:CNode_221{[0]: ValueNode<DoSignaturePrimitive> S_Prim_inner_len, [1]: CNode_222}
#   2: @mindspore_nn_layer_container_SequentialCell_construct_142:CNode_220{[0]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_219, [1]: ValueNode<Int64Imm> 0, [2]: param_input_data}
#   3: @mindspore_nn_layer_container_SequentialCell_construct_142:CNode_223{[0]: ValueNode<Primitive> Return, [1]: CNode_220}


subgraph attr:
subgraph instance: argmin_149 : 0x16db1060
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @argmin_149() {
  %1(CNode_224) = S_Prim_MakeTuple()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
  %2(CNode_225) = S_Prim_MakeTuple()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
  %3(CNode_226) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
  %4(CNode_227) = PyInterpret[side_effect_io: Bool(1)](Script['Tensor(0)'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
  Return(%4)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:664/        return Tensor(0)/
}
# Order:
#   1: @argmin_149:CNode_224{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple}
#   2: @argmin_149:CNode_225{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple}
#   3: @argmin_149:CNode_226{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_224, [2]: CNode_225}
#   4: @argmin_149:CNode_227{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'Tensor(0)', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'Tensor': <class 'mindspore.common.tensor.Tensor'>}), [3]: CNode_226}
#   5: @argmin_149:CNode_228{[0]: ValueNode<Primitive> Return, [1]: CNode_227}


subgraph attr:
subgraph instance: argmin_150 : 0x16da1790
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @argmin_150 parent: [subgraph @argmin_70]() {
  %1(CNode_230) = call @argmin_229()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:663/    if not input.shape:/
}
# Order:
#   1: @argmin_150:CNode_230{[0]: ValueNode<FuncGraph> argmin_229}
#   2: @argmin_150:CNode_231{[0]: ValueNode<Primitive> Return, [1]: CNode_230}


subgraph attr:
subgraph instance: matmul_162 : 0x16e09b60
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_162() {
  %1(CNode_232) = raise[side_effect_io: Bool(1)]("TypeError", "For matmul op, inputs must be all tensors.", "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9660/        raise TypeError("For matmul op, inputs must be all tensors.")/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9660/        raise TypeError("For matmul op, inputs must be all tensors.")/
}
# Order:
#   1: @matmul_162:CNode_232{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: ValueNode<StringImm> For matmul op, inputs must be all tensors., [3]: ValueNode<StringImm> None}
#   2: @matmul_162:CNode_233{[0]: ValueNode<Primitive> Return, [1]: CNode_232}


subgraph attr:
subgraph instance: matmul_163 : 0x16d74ed0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_163 parent: [subgraph @matmul_62]() {
  %1(CNode_235) = call @matmul_234()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
}
# Order:
#   1: @matmul_163:CNode_235{[0]: ValueNode<FuncGraph> matmul_234}
#   2: @matmul_163:CNode_236{[0]: ValueNode<Primitive> Return, [1]: CNode_235}


subgraph attr:
subgraph instance: matmul_156 : 0x16d73e60
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_156 parent: [subgraph @matmul_62]() {
  %1(CNode_237) = S_Prim_isinstance(%para22_other, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
}
# Order:
#   1: @matmul_156:CNode_237{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_other, [2]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor'}
#   2: @matmul_156:CNode_238{[0]: ValueNode<Primitive> Return, [1]: CNode_237}


subgraph attr:
subgraph instance: matmul_157 : 0x16ddd0e0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_157 parent: [subgraph @matmul_62]() {
  %1(CNode_153) = $(matmul_62):S_Prim_isinstance(%para21_input, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9659/    if not (isinstance(input, Tensor) and isinstance(other, Tensor)):/
}
# Order:
#   1: @matmul_157:CNode_239{[0]: ValueNode<Primitive> Return, [1]: CNode_153}


subgraph attr:
subgraph instance: sum_170 : 0x16dd7280
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @sum_170 parent: [subgraph @sum_47]() {
  %1(CNode_240) = S_Prim_MakeTuple("input")
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  %2(CNode_241) = S_Prim_MakeTuple(%para23_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  %3(CNode_242) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  %4(CNode_243) = PyInterpret[side_effect_io: Bool(1)](Script['f"For 'sum', 'input' must be Tensor, but got{type(input)}"'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  %5(CNode_244) = raise[side_effect_io: Bool(1)]("TypeError", %4, "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12011/        raise TypeError(f"For 'sum', 'input' must be Tensor, but got{type(input)}")/
}
# Order:
#   1: @sum_170:CNode_240{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> input}
#   2: @sum_170:CNode_241{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_input}
#   3: @sum_170:CNode_242{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_240, [2]: CNode_241}
#   4: @sum_170:CNode_243{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'f"For 'sum', 'input' must be Tensor, but got{type(input)}"', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'isinstance': <built-in function isinstance>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>, 'type': <class 'type'>}), [3]: CNode_242}
#   5: @sum_170:CNode_244{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: CNode_243, [3]: ValueNode<StringImm> None}
#   6: @sum_170:CNode_245{[0]: ValueNode<Primitive> Return, [1]: CNode_244}


subgraph attr:
subgraph instance: sum_171 : 0x16db7330
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @sum_171 parent: [subgraph @sum_47]() {
  %1(CNode_247) = call @sum_246()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12010/    if not isinstance(input, Tensor):/
}
# Order:
#   1: @sum_171:CNode_247{[0]: ValueNode<FuncGraph> sum_246}
#   2: @sum_171:CNode_248{[0]: ValueNode<Primitive> Return, [1]: CNode_247}


subgraph attr:
subgraph instance: tensor_scatter_elements_178 : 0x16a9dd40
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:3922/def tensor_scatter_elements(input_x, indices, updates, axis=0, reduction="none"):/
subgraph @tensor_scatter_elements_178(%para42_input_x, %para43_indices, %para44_updates, %para45_axis, %para46_reduction) {
  %1(CNode_249) = call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4003/    _tensor_scatter_elements = _get_cache_prim(TensorScatterElements)(axis, reduction)/
  %2(_tensor_scatter_elements) = %1(%para45_axis, %para46_reduction)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4003/    _tensor_scatter_elements = _get_cache_prim(TensorScatterElements)(axis, reduction)/
  %3(CNode_250) = %2(%para42_input_x, %para43_indices, %para44_updates)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4004/    return _tensor_scatter_elements(input_x, indices, updates)/
  Return(%3)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:4004/    return _tensor_scatter_elements(input_x, indices, updates)/
}
# Order:
#   1: @tensor_scatter_elements_178:CNode_249{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.array_ops.TensorScatterElements'}
#   2: @tensor_scatter_elements_178:_tensor_scatter_elements{[0]: CNode_249, [1]: param_axis, [2]: param_reduction}
#   3: @tensor_scatter_elements_178:CNode_250{[0]: _tensor_scatter_elements, [1]: param_input_x, [2]: param_indices, [3]: param_updates}
#   4: @tensor_scatter_elements_178:CNode_251{[0]: ValueNode<Primitive> Return, [1]: CNode_250}


subgraph attr:
subgraph instance: ones_like_185 : 0x16d6b190
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:998/    _dtype = input.dtype if dtype is None else dtype/
subgraph @ones_like_185 parent: [subgraph @ones_like_81]() {
  %1(CNode_252) = getattr(%para31_input, "dtype")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:998/    _dtype = input.dtype if dtype is None else dtype/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:998/    _dtype = input.dtype if dtype is None else dtype/
}
# Order:
#   1: @ones_like_185:CNode_252{[0]: ValueNode<Primitive> getattr, [1]: param_input, [2]: ValueNode<StringImm> dtype}
#   2: @ones_like_185:CNode_253{[0]: ValueNode<Primitive> Return, [1]: CNode_252}


subgraph attr:
subgraph instance: ones_like_186 : 0x16d6a390
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:998/    _dtype = input.dtype if dtype is None else dtype/
subgraph @ones_like_186 parent: [subgraph @ones_like_81]() {
  Return(%para32_dtype)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:998/    _dtype = input.dtype if dtype is None else dtype/
}
# Order:
#   1: @ones_like_186:CNode_254{[0]: ValueNode<Primitive> Return, [1]: param_dtype}


subgraph attr:
subgraph instance: _get_cache_prim_19 : 0x16c288e0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:35/def _get_cache_prim(cls: Primitive) -> Primitive:/
subgraph @_get_cache_prim_19(%para47_cls) {
  %1(CNode_256) = call @_get_cache_prim_255()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:88/    if _is_need_compile(_temp_func): # @jit.cond: True/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:88/    if _is_need_compile(_temp_func): # @jit.cond: True/
}
# Order:
#   1: @_get_cache_prim_19:CNode_256{[0]: ValueNode<FuncGraph> _get_cache_prim_255}
#   2: @_get_cache_prim_19:CNode_257{[0]: ValueNode<Primitive> Return, [1]: CNode_256}


subgraph attr:
subgraph instance: zeros_200 : 0x16d9d410
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
subgraph @zeros_200() {
  Return(F32)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
}
# Order:
#   1: @zeros_200:CNode_258{[0]: ValueNode<Primitive> Return, [1]: ValueNode<Float> Float32}


subgraph attr:
subgraph instance: zeros_201 : 0x16d9c570
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
subgraph @zeros_201 parent: [subgraph @zeros_75]() {
  Return(%para34_dtype)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
}
# Order:
#   1: @zeros_201:CNode_259{[0]: ValueNode<Primitive> Return, [1]: param_dtype}


subgraph attr:
after_block : 1
subgraph instance: zeros_194 : 0x16d9b0e0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @zeros_194 parent: [subgraph @zeros_75](%para48_) {
  %1(CNode_196) = $(zeros_75):call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1031/    zero_op = _get_cache_prim(P.FillV2)()/
  %2(zero_op) = $(zeros_75):%1()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1031/    zero_op = _get_cache_prim(P.FillV2)()/
  %3(CNode_202) = $(zeros_75):S_Prim_MakeTuple("_dtype")
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1033/    value = Tensor(0, _dtype)/
  %4(CNode_197) = $(zeros_75):S_Prim_is_(%para34_dtype, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
  %5(CNode_198) = $(zeros_75):Cond(%4, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
  %6(CNode_199) = $(zeros_75):Switch(%5, @zeros_200, @zeros_201)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
  %7(_dtype) = $(zeros_75):%6()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1032/    _dtype = mstype.float32 if dtype is None else dtype/
  %8(CNode_203) = $(zeros_75):S_Prim_MakeTuple(%7)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1033/    value = Tensor(0, _dtype)/
  %9(CNode_204) = $(zeros_75):S_Prim_make_dict(%3, %8)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1033/    value = Tensor(0, _dtype)/
  %10(value) = $(zeros_75):PyInterpret[side_effect_io: Bool(1)](Script['Tensor(0, _dtype)'], InterpretedObject, %9)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1033/    value = Tensor(0, _dtype)/
  %11(output) = %2(%para48_size, %10)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1040/    output = zero_op(size, value)/
  Return(%11)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1041/    return output/
}
# Order:
#   1: @zeros_194:output{[0]: zero_op, [1]: param_size, [2]: value}
#   2: @zeros_194:CNode_260{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
subgraph instance: zeros_191 : 0x16d99c00
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @zeros_191 parent: [subgraph @zeros_75]() {
  %1(CNode_261) = S_Prim_make_list(%para33_size)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1035/        size = tuple([size])/
  %2(size) = ClassType(%1)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1035/        size = tuple([size])/
  Return(%2)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1035/        size = tuple([size])/
}
# Order:
#   1: @zeros_191:CNode_261{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_list, [1]: param_size}
#   2: @zeros_191:size{[0]: ValueNode<ClassType> class 'tuple', [1]: CNode_261}
#   3: @zeros_191:CNode_262{[0]: ValueNode<Primitive> Return, [1]: size}


subgraph attr:
subgraph instance: zeros_192 : 0x16c91870
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @zeros_192 parent: [subgraph @zeros_75]() {
  %1(CNode_263) = S_Prim_isinstance(%para33_size, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
  %2(CNode_264) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
  %3(CNode_265) = Switch(%2, @zeros_266, @2zeros_267)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
  %4(CNode_268) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
  Return(%4)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
}
# Order:
#   1: @zeros_192:CNode_263{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_size, [2]: ValueNode<ClassType> class 'list'}
#   2: @zeros_192:CNode_264{[0]: ValueNode<Primitive> Cond, [1]: CNode_263, [2]: ValueNode<BoolImm> false}
#   3: @zeros_192:CNode_265{[0]: ValueNode<Primitive> Switch, [1]: CNode_264, [2]: ValueNode<FuncGraph> zeros_266, [3]: ValueNode<FuncGraph> 2zeros_267}
#   4: @zeros_192:CNode_268{[0]: CNode_265}
#   5: @zeros_192:CNode_269{[0]: ValueNode<Primitive> Return, [1]: CNode_268}


subgraph attr:
after_block : 1
subgraph instance: mean_212 : 0x16e0f9b0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @mean_212 parent: [subgraph @mean_95](%para49_) {
  %1(CNode_135) = call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
  %2(CNode_136) = %1(%para39_keep_dims)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
  %3(CNode_137) = %2(%para37_x, %para49_axis)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
  Return(%3)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8443/    return _get_cache_prim(P.ReduceMean)(keep_dims)(x, axis)/
}
# Order:
#   1: @mean_212:CNode_135{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.ReduceMean'}
#   2: @mean_212:CNode_136{[0]: CNode_135, [1]: param_keep_dims}
#   3: @mean_212:CNode_137{[0]: CNode_136, [1]: param_x, [2]: param_axis}
#   4: @mean_212:CNode_138{[0]: ValueNode<Primitive> Return, [1]: CNode_137}


subgraph attr:
subgraph instance: mean_210 : 0x16e0eb40
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @mean_210() {
  Return(())
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8442/        axis = ()/
}
# Order:
#   1: @mean_210:CNode_270{[0]: ValueNode<Primitive> Return, [1]: ValueNode<ValueTuple> ()}


subgraph attr:
subgraph instance: mean_211 : 0x16e0dd70
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8364/def mean(x, axis=None, keep_dims=False):/
subgraph @mean_211 parent: [subgraph @mean_95]() {
  Return(%para38_axis)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:8441/    if axis is None:/
}
# Order:
#   1: @mean_211:CNode_271{[0]: ValueNode<Primitive> Return, [1]: param_axis}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_216 : 0x16b80460
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_216 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_32]() {
  %1(output) = $(mindspore_nn_layer_conv_Conv2d_construct_32):S_Prim_Conv2D[kernel_size: (I64(1), I64(1)), mode: I64(1), out_channel: I64(64), input_names: ["x", "w"], pad: (I64(0), I64(0), I64(0), I64(0)), pad_mode: I64(1), format: "NCHW", pad_list: (I64(0), I64(0), I64(0), I64(0)), groups: I64(1), stride: (I64(1), I64(1), I64(1), I64(1)), group: I64(1), dilation: (I64(1), I64(1), I64(1), I64(1)), output_names: ["output"]](%para16_x, %para2_pre_quantization_conv.weight)
      : (<null>, <Ref[Tensor[Float32]], (64, 128, 1, 1), ref_key=:pre_quantization_conv.weight>) -> (<null>)
      #scope: (Default/pre_quantization_conv-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:361/        output = self.conv2d(x, self.weight)/
  Return(%1)
      : (<null>)
      #scope: (Default/pre_quantization_conv-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:364/        return output/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_216:CNode_272{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_273 : 0x16b9e6f0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_273 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para50_x) {
  %1(CNode_275) = call @mindspore_nn_layer_conv_Conv2d_construct_274()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/0-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/0-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_273:output{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Conv2D, [1]: param_x, [2]: param_encoder.conv_stack.0.weight}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_273:CNode_275{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_274}
#   3: @mindspore_nn_layer_conv_Conv2d_construct_273:CNode_276{[0]: ValueNode<Primitive> Return, [1]: CNode_275}


subgraph attr:
subgraph instance: mindspore_nn_layer_activation_ReLU_construct_277 : 0x16bafbe0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:437/    def construct(self, x):/
subgraph @mindspore_nn_layer_activation_ReLU_construct_277(%para51_x) {
  %1(CNode_278) = S_Prim_ReLU[output_names: ["output"], input_names: ["x"]](%para51_x)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/1-ReLU)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:438/        return self.relu(x)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/1-ReLU)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:438/        return self.relu(x)/
}
# Order:
#   1: @mindspore_nn_layer_activation_ReLU_construct_277:CNode_278{[0]: ValueNode<DoSignaturePrimitive> S_Prim_ReLU, [1]: param_x}
#   2: @mindspore_nn_layer_activation_ReLU_construct_277:CNode_279{[0]: ValueNode<Primitive> Return, [1]: CNode_278}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_280 : 0x16a99a20
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_280 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para52_x) {
  %1(CNode_282) = call @mindspore_nn_layer_conv_Conv2d_construct_281()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/2-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/2-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_280:output{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Conv2D, [1]: param_x, [2]: param_encoder.conv_stack.2.weight}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_280:CNode_282{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_281}
#   3: @mindspore_nn_layer_conv_Conv2d_construct_280:CNode_283{[0]: ValueNode<Primitive> Return, [1]: CNode_282}


subgraph attr:
subgraph instance: mindspore_nn_layer_activation_ReLU_construct_284 : 0x16a54b30
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:437/    def construct(self, x):/
subgraph @mindspore_nn_layer_activation_ReLU_construct_284(%para53_x) {
  %1(CNode_285) = S_Prim_ReLU[output_names: ["output"], input_names: ["x"]](%para53_x)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/3-ReLU)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:438/        return self.relu(x)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/3-ReLU)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:438/        return self.relu(x)/
}
# Order:
#   1: @mindspore_nn_layer_activation_ReLU_construct_284:CNode_285{[0]: ValueNode<DoSignaturePrimitive> S_Prim_ReLU, [1]: param_x}
#   2: @mindspore_nn_layer_activation_ReLU_construct_284:CNode_286{[0]: ValueNode<Primitive> Return, [1]: CNode_285}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_287 : 0x16a67180
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_287 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para54_x) {
  %1(CNode_289) = call @mindspore_nn_layer_conv_Conv2d_construct_288()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/4-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/4-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_287:output{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Conv2D, [1]: param_x, [2]: param_encoder.conv_stack.4.weight}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_287:CNode_289{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_288}
#   3: @mindspore_nn_layer_conv_Conv2d_construct_287:CNode_290{[0]: ValueNode<Primitive> Return, [1]: CNode_289}


subgraph attr:
subgraph instance: videogvt_models_vqvae_residual_ResidualStack_construct_291 : 0x16ae2740
# In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:46/    def construct(self, x):/
subgraph @videogvt_models_vqvae_residual_ResidualStack_construct_291 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para55_x) {
  %1(CNode_293) = call @videogvt_models_vqvae_residual_ResidualStack_construct_292(I64(0), %para55_x)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
}
# Order:
#   1: @videogvt_models_vqvae_residual_ResidualStack_construct_291:CNode_294{[0]: ValueNode<DoSignaturePrimitive> S_Prim_inner_len, [1]: CNode_295}
#   2: @videogvt_models_vqvae_residual_ResidualStack_construct_291:CNode_296{[0]: ValueNode<Primitive> Return, [1]: CNode_293}
#   3: @videogvt_models_vqvae_residual_ResidualStack_construct_291:CNode_293{[0]: ValueNode<FuncGraph> videogvt_models_vqvae_residual_ResidualStack_construct_292, [1]: ValueNode<Int64Imm> 0, [2]: param_x}


subgraph attr:
subgraph instance: mindspore_nn_layer_container_SequentialCell_construct_219 : 0x16cb5970
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
subgraph @mindspore_nn_layer_container_SequentialCell_construct_219 parent: [subgraph @mindspore_nn_layer_container_SequentialCell_construct_142](%para56_, %para57_) {
  %1(CNode_222) = $(mindspore_nn_layer_container_SequentialCell_construct_142):MakeTuple(@mindspore_nn_layer_conv_Conv2d_construct_273, @mindspore_nn_layer_activation_ReLU_construct_277, @mindspore_nn_layer_conv_Conv2d_construct_280, @mindspore_nn_layer_activation_ReLU_construct_284, @mindspore_nn_layer_conv_Conv2d_construct_287, @videogvt_models_vqvae_residual_ResidualStack_construct_291)
      : (<null>, <null>, <null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %2(CNode_221) = $(mindspore_nn_layer_container_SequentialCell_construct_142):S_Prim_inner_len(%1)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %3(CNode_297) = MultitypeFuncGraph_less{(List, List), (Tensor, Number), (Tensor, Tensor), (Tuple, Tuple), (Number, Tensor), (String, String), (Number, Number)}(%para56_@CNode_298, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %4(CNode_299) = Switch(%3, @mindspore_nn_layer_container_SequentialCell_construct_300, @mindspore_nn_layer_container_SequentialCell_construct_301)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %5(CNode_302) = %4()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  Return(%5)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
}
# Order:
#   1: @mindspore_nn_layer_container_SequentialCell_construct_219:CNode_297{[0]: ValueNode<MultitypeFuncGraph> MetaFuncGraph-less.303, [1]: param_@CNode_298, [2]: CNode_221}
#   2: @mindspore_nn_layer_container_SequentialCell_construct_219:CNode_299{[0]: ValueNode<Primitive> Switch, [1]: CNode_297, [2]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_300, [3]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_301}
#   3: @mindspore_nn_layer_container_SequentialCell_construct_219:CNode_302{[0]: CNode_299}
#   4: @mindspore_nn_layer_container_SequentialCell_construct_219:CNode_304{[0]: ValueNode<Primitive> Return, [1]: CNode_302}


subgraph attr:
after_block : 1
subgraph instance: argmin_229 : 0x16da2dc0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @argmin_229 parent: [subgraph @argmin_70]() {
  %1(CNode_305) = S_Prim_is_(%para19_axis, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
  %2(CNode_306) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
  %3(CNode_307) = Switch(%2, @argmin_308, @argmin_309)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
  %4(CNode_310) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
  Return(%4)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
}
# Order:
#   1: @argmin_229:CNode_305{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_, [1]: param_axis, [2]: ValueNode<None> None}
#   2: @argmin_229:CNode_306{[0]: ValueNode<Primitive> Cond, [1]: CNode_305, [2]: ValueNode<BoolImm> false}
#   3: @argmin_229:CNode_307{[0]: ValueNode<Primitive> Switch, [1]: CNode_306, [2]: ValueNode<FuncGraph> argmin_308, [3]: ValueNode<FuncGraph> argmin_309}
#   4: @argmin_229:CNode_310{[0]: CNode_307}
#   5: @argmin_229:CNode_311{[0]: ValueNode<Primitive> Return, [1]: CNode_310}


subgraph attr:
after_block : 1
subgraph instance: matmul_234 : 0x16d83ff0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_234 parent: [subgraph @matmul_62]() {
  %1(CNode_312) = S_Prim_Rank(%para21_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %2(CNode_313) = S_Prim_Rank(%para22_other)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %3(CNode_314) = S_Prim_MakeTuple(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %4(input_rank) = S_Prim_getitem(%3, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %5(CNode_315) = S_Prim_equal(%4, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %6(CNode_316) = Cond(%5, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %7(CNode_317) = Switch(%6, @matmul_318, @matmul_319)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %8(CNode_320) = %7()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %9(CNode_321) = Cond(%8, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %10(CNode_322) = Switch(%9, @matmul_323, @matmul_324)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  %11(CNode_325) = %10()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  Return(%11)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
}
# Order:
#   1: @matmul_234:CNode_312{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: param_input}
#   2: @matmul_234:CNode_313{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: param_other}
#   3: @matmul_234:CNode_314{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_312, [2]: CNode_313}
#   4: @matmul_234:input_rank{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_314, [2]: ValueNode<Int64Imm> 0}
#   5: @matmul_234:other_rank{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_314, [2]: ValueNode<Int64Imm> 1}
#   6: @matmul_234:CNode_315{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: input_rank, [2]: ValueNode<Int64Imm> 2}
#   7: @matmul_234:CNode_316{[0]: ValueNode<Primitive> Cond, [1]: CNode_315, [2]: ValueNode<BoolImm> false}
#   8: @matmul_234:CNode_317{[0]: ValueNode<Primitive> Switch, [1]: CNode_316, [2]: ValueNode<FuncGraph> matmul_318, [3]: ValueNode<FuncGraph> matmul_319}
#   9: @matmul_234:CNode_320{[0]: CNode_317}
#  10: @matmul_234:CNode_321{[0]: ValueNode<Primitive> Cond, [1]: CNode_320, [2]: ValueNode<BoolImm> false}
#  11: @matmul_234:CNode_322{[0]: ValueNode<Primitive> Switch, [1]: CNode_321, [2]: ValueNode<FuncGraph> matmul_323, [3]: ValueNode<FuncGraph> matmul_324}
#  12: @matmul_234:CNode_325{[0]: CNode_322}
#  13: @matmul_234:CNode_326{[0]: ValueNode<Primitive> Return, [1]: CNode_325}


subgraph attr:
after_block : 1
subgraph instance: sum_246 : 0x16db8b70
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @sum_246 parent: [subgraph @sum_47]() {
  %1(CNode_327) = S_Prim_is_not(%para24_dim, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %2(CNode_328) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %3(CNode_329) = Switch(%2, @sum_330, @sum_331)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %4(CNode_332) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %5(CNode_333) = Cond(%4, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %6(CNode_334) = Switch(%5, @sum_335, @sum_336)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %7(CNode_337) = %6()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  Return(%7)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
}
# Order:
#   1: @sum_246:CNode_327{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_not, [1]: param_dim, [2]: ValueNode<None> None}
#   2: @sum_246:CNode_328{[0]: ValueNode<Primitive> Cond, [1]: CNode_327, [2]: ValueNode<BoolImm> false}
#   3: @sum_246:CNode_329{[0]: ValueNode<Primitive> Switch, [1]: CNode_328, [2]: ValueNode<FuncGraph> sum_330, [3]: ValueNode<FuncGraph> sum_331}
#   4: @sum_246:CNode_332{[0]: CNode_329}
#   5: @sum_246:CNode_333{[0]: ValueNode<Primitive> Cond, [1]: CNode_332, [2]: ValueNode<BoolImm> false}
#   6: @sum_246:CNode_334{[0]: ValueNode<Primitive> Switch, [1]: CNode_333, [2]: ValueNode<FuncGraph> sum_335, [3]: ValueNode<FuncGraph> sum_336}
#   7: @sum_246:CNode_337{[0]: CNode_334}
#   8: @sum_246:CNode_338{[0]: ValueNode<Primitive> Return, [1]: CNode_337}


subgraph attr:
subgraph instance: _get_cache_prim_255 : 0x16c07000
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:35/def _get_cache_prim(cls: Primitive) -> Primitive:/
subgraph @_get_cache_prim_255 parent: [subgraph @_get_cache_prim_19]() {
  Return(@_new_prim_for_graph_20)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:89/        return _new_prim_for_graph/
}
# Order:
#   1: @_get_cache_prim_255:CNode_339{[0]: ValueNode<Primitive> Return, [1]: ValueNode<FuncGraph> _new_prim_for_graph_20}


subgraph attr:
subgraph instance: zeros_266 : 0x16d7d510
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @zeros_266 parent: [subgraph @zeros_75]() {
  %1(CNode_340) = S_Prim_MakeTuple("size")
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
  %2(CNode_341) = S_Prim_MakeTuple(%para33_size)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
  %3(CNode_342) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
  %4(size) = PyInterpret[side_effect_io: Bool(1)](Script['Tensor(size, dtype=mstype.int64)'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
  %5(CNode_344) = call @zeros_343(%4)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:52/        min_encodings = ops.zeros(/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1037/        size = Tensor(size, dtype=mstype.int64)/
}
# Order:
#   1: @zeros_266:CNode_340{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> size}
#   2: @zeros_266:CNode_341{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_size}
#   3: @zeros_266:CNode_342{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_340, [2]: CNode_341}
#   4: @zeros_266:size{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'Tensor(size, dtype=mstype.int64)', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'_get_cache_prim': <function _get_cache_prim at 0x7f933db57d30>, 'P': <module 'mindspore.ops.operations' from '/disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/operations/__init__.py'>, 'mstype': <module 'mindspore.common.dtype' from '/disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/common/dtype.py'>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>, 'isinstance': <built-in function isinstance>, 'int': <class 'int'>, 'tuple': <class 'tuple'>, 'list': <class 'list'>}), [3]: CNode_342}
#   5: @zeros_266:CNode_345{[0]: ValueNode<Primitive> Return, [1]: CNode_344}
#   6: @zeros_266:CNode_344{[0]: ValueNode<FuncGraph> zeros_343, [1]: size}


subgraph attr:
subgraph instance: 2zeros_267 : 0x16b920a0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @2zeros_267 parent: [subgraph @zeros_75]() {
  %1(CNode_346) = S_Prim_isinstance(%para33_size, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %2(CNode_347) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %3(CNode_348) = Switch(%2, @2zeros_349, @2zeros_350)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %4(CNode_351) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %5(CNode_352) = Cond(%4, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %6(CNode_353) = Switch(%5, @2zeros_354, @3zeros_355)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %7(CNode_356) = %6()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %8(CNode_358) = call @2zeros_357(%7)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:52/        min_encodings = ops.zeros(/
  Return(%8)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @2zeros_267:CNode_346{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_size, [2]: ValueNode<ClassType> class 'mindspore.common.tensor.Tensor'}
#   2: @2zeros_267:CNode_347{[0]: ValueNode<Primitive> Cond, [1]: CNode_346, [2]: ValueNode<BoolImm> false}
#   3: @2zeros_267:CNode_348{[0]: ValueNode<Primitive> Switch, [1]: CNode_347, [2]: ValueNode<FuncGraph> 2zeros_349, [3]: ValueNode<FuncGraph> 2zeros_350}
#   4: @2zeros_267:CNode_351{[0]: CNode_348}
#   5: @2zeros_267:CNode_352{[0]: ValueNode<Primitive> Cond, [1]: CNode_351, [2]: ValueNode<BoolImm> false}
#   6: @2zeros_267:CNode_353{[0]: ValueNode<Primitive> Switch, [1]: CNode_352, [2]: ValueNode<FuncGraph> 2zeros_354, [3]: ValueNode<FuncGraph> 3zeros_355}
#   7: @2zeros_267:CNode_356{[0]: CNode_353}
#   8: @2zeros_267:CNode_358{[0]: ValueNode<FuncGraph> 2zeros_357, [1]: CNode_356}
#   9: @2zeros_267:CNode_359{[0]: ValueNode<Primitive> Return, [1]: CNode_358}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_274 : 0x16b718b0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_274 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_273]() {
  %1(CNode_361) = call @mindspore_nn_layer_conv_Conv2d_construct_360()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/0-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/0-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_274:CNode_361{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_360}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_274:CNode_362{[0]: ValueNode<Primitive> Return, [1]: CNode_361}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_281 : 0x16c6c670
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_281 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_280]() {
  %1(CNode_364) = call @mindspore_nn_layer_conv_Conv2d_construct_363()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/2-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/2-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_281:CNode_364{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_363}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_281:CNode_365{[0]: ValueNode<Primitive> Return, [1]: CNode_364}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_288 : 0x16bf51a0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_288 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_287]() {
  %1(CNode_367) = call @mindspore_nn_layer_conv_Conv2d_construct_366()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/4-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/4-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_288:CNode_367{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_366}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_288:CNode_368{[0]: ValueNode<Primitive> Return, [1]: CNode_367}


subgraph attr:
subgraph instance: videogvt_models_vqvae_residual_ResidualLayer_construct_369 : 0x16bf65f0
# In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:26/    def construct(self, x):/
subgraph @videogvt_models_vqvae_residual_ResidualLayer_construct_369 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para58_x) {
  %1(CNode_371) = call @mindspore_nn_layer_container_SequentialCell_construct_370(%para58_x)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:27/        x = x + self.res_block(x)/
  %2(x) = S_Prim_add(%para58_x, %1)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:27/        x = x + self.res_block(x)/
  Return(%2)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:28/        return x/
}
# Order:
#   1: @videogvt_models_vqvae_residual_ResidualLayer_construct_369:CNode_371{[0]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_370, [1]: param_x}
#   2: @videogvt_models_vqvae_residual_ResidualLayer_construct_369:x{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: param_x, [2]: CNode_371}
#   3: @videogvt_models_vqvae_residual_ResidualLayer_construct_369:CNode_372{[0]: ValueNode<Primitive> Return, [1]: x}


subgraph attr:
subgraph instance: videogvt_models_vqvae_residual_ResidualStack_construct_292 : 0x16c26db0
# In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:46/    def construct(self, x):/
subgraph @videogvt_models_vqvae_residual_ResidualStack_construct_292 parent: [subgraph @videogvt_models_vqvae_residual_ResidualStack_construct_291](%para59_, %para60_) {
  %1(CNode_295) = $(videogvt_models_vqvae_residual_ResidualStack_construct_291):MakeTuple(@videogvt_models_vqvae_residual_ResidualLayer_construct_369, @videogvt_models_vqvae_residual_ResidualLayer_construct_369)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  %2(CNode_294) = $(videogvt_models_vqvae_residual_ResidualStack_construct_291):S_Prim_inner_len(%1)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  %3(CNode_373) = MultitypeFuncGraph_less{(List, List), (Tensor, Number), (Tensor, Tensor), (Tuple, Tuple), (Number, Tensor), (String, String), (Number, Number)}(%para59_@CNode_374, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  %4(CNode_375) = Switch(%3, @videogvt_models_vqvae_residual_ResidualStack_construct_376, @videogvt_models_vqvae_residual_ResidualStack_construct_377)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  %5(CNode_378) = %4()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  Return(%5)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
}
# Order:
#   1: @videogvt_models_vqvae_residual_ResidualStack_construct_292:CNode_373{[0]: ValueNode<MultitypeFuncGraph> MetaFuncGraph-less.303, [1]: param_@CNode_374, [2]: CNode_294}
#   2: @videogvt_models_vqvae_residual_ResidualStack_construct_292:CNode_375{[0]: ValueNode<Primitive> Switch, [1]: CNode_373, [2]: ValueNode<FuncGraph> videogvt_models_vqvae_residual_ResidualStack_construct_376, [3]: ValueNode<FuncGraph> videogvt_models_vqvae_residual_ResidualStack_construct_377}
#   3: @videogvt_models_vqvae_residual_ResidualStack_construct_292:CNode_378{[0]: CNode_375}
#   4: @videogvt_models_vqvae_residual_ResidualStack_construct_292:CNode_379{[0]: ValueNode<Primitive> Return, [1]: CNode_378}


subgraph attr:
subgraph instance: mindspore_nn_layer_container_SequentialCell_construct_300 : 0x16be7e80
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
subgraph @mindspore_nn_layer_container_SequentialCell_construct_300 parent: [subgraph @mindspore_nn_layer_container_SequentialCell_construct_219]() {
  %1(CNode_298) = MultitypeFuncGraph_add{(COOTensor, COOTensor), (CSRTensor, CSRTensor), (Number, Number), (String, String), (Tensor, List), (Tuple, Tuple), (Dictionary, Dictionary), (Tensor, Number), (Number, Tensor), (Tuple, Tensor), (Tensor, Tuple), (COOTensor, Tensor), (List, List), (Tensor, COOTensor), (Tensor, Tensor), (List, Tensor), (RowTensor, Tensor), (NoneType, NoneType)}(%para56_@CNode_298, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %2(CNode_380) = StopGradient(%1)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
  %3(CNode_222) = $(mindspore_nn_layer_container_SequentialCell_construct_142):MakeTuple(@mindspore_nn_layer_conv_Conv2d_construct_273, @mindspore_nn_layer_activation_ReLU_construct_277, @mindspore_nn_layer_conv_Conv2d_construct_280, @mindspore_nn_layer_activation_ReLU_construct_284, @mindspore_nn_layer_conv_Conv2d_construct_287, @videogvt_models_vqvae_residual_ResidualStack_construct_291)
      : (<null>, <null>, <null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %4(CNode_381) = call @ms_iter_3(%3)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %5(cell) = S_Prim_getitem(%4, %para56_@CNode_298)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %6(input_data) = %5(%para57_input_data)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:295/            input_data = cell(input_data)/
  %7(CNode_382) = call @mindspore_nn_layer_container_SequentialCell_construct_219(%1, %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %8(CNode_383) = Depend[side_effect_propagate: I64(1)](%7, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  Return(%8)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
}
# Order:
#   1: @mindspore_nn_layer_container_SequentialCell_construct_300:CNode_381{[0]: ValueNode<FuncGraph> ms_iter_3, [1]: CNode_222}
#   2: @mindspore_nn_layer_container_SequentialCell_construct_300:cell{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_381, [2]: param_@CNode_298}
#   3: @mindspore_nn_layer_container_SequentialCell_construct_300:CNode_298{[0]: ValueNode<MultitypeFuncGraph> MetaFuncGraph-add.4, [1]: param_@CNode_298, [2]: ValueNode<Int64Imm> 1}
#   4: @mindspore_nn_layer_container_SequentialCell_construct_300:input_data{[0]: cell, [1]: param_input_data}
#   5: @mindspore_nn_layer_container_SequentialCell_construct_300:CNode_382{[0]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_219, [1]: CNode_298, [2]: input_data}
#   6: @mindspore_nn_layer_container_SequentialCell_construct_300:CNode_384{[0]: ValueNode<Primitive> Return, [1]: CNode_383}


subgraph attr:
subgraph instance: mindspore_nn_layer_container_SequentialCell_construct_301 : 0x16a95110
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
subgraph @mindspore_nn_layer_container_SequentialCell_construct_301 parent: [subgraph @mindspore_nn_layer_container_SequentialCell_construct_219]() {
  Return(%para57_input_data)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:296/        return input_data/
}
# Order:
#   1: @mindspore_nn_layer_container_SequentialCell_construct_301:CNode_385{[0]: ValueNode<Primitive> Return, [1]: param_input_data}


subgraph attr:
subgraph instance: argmin_308 : 0x16daf070
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @argmin_308 parent: [subgraph @argmin_70]() {
  %1(CNode_386) = S_Prim_negative(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:667/        input = reshape_(input, (-1,))/
  %2(CNode_387) = S_Prim_MakeTuple(%1)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:667/        input = reshape_(input, (-1,))/
  %3(input) = S_Prim_Reshape[output_names: ["output"], input_names: ["tensor", "shape"]](%para18_input, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:667/        input = reshape_(input, (-1,))/
  %4(CNode_389) = call @2argmin_388(I64(0), %3, Bool(1))
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  Return(%4)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:667/        input = reshape_(input, (-1,))/
}
# Order:
#   1: @argmin_308:CNode_386{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 1}
#   2: @argmin_308:CNode_387{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_386}
#   3: @argmin_308:input{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Reshape, [1]: param_input, [2]: CNode_387}
#   4: @argmin_308:CNode_390{[0]: ValueNode<Primitive> Return, [1]: CNode_389}
#   5: @argmin_308:CNode_389{[0]: ValueNode<FuncGraph> 2argmin_388, [1]: ValueNode<Int64Imm> 0, [2]: input, [3]: ValueNode<BoolImm> true}


subgraph attr:
subgraph instance: argmin_309 : 0x16da4c10
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @argmin_309 parent: [subgraph @argmin_70]() {
  %1(CNode_391) = call @2argmin_388(%para19_axis, %para18_input, Bool(0))
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:666/    if axis is None:/
}
# Order:
#   1: @argmin_309:CNode_392{[0]: ValueNode<Primitive> Return, [1]: CNode_391}
#   2: @argmin_309:CNode_391{[0]: ValueNode<FuncGraph> 2argmin_388, [1]: param_axis, [2]: param_input, [3]: ValueNode<BoolImm> false}


subgraph attr:
subgraph instance: matmul_323 : 0x16e08190
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_323 parent: [subgraph @matmul_62]() {
  %1(CNode_393) = call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9664/        _matmul = _get_cache_prim(P.MatMul)(False, False)/
  %2(_matmul) = %1(Bool(0), Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9664/        _matmul = _get_cache_prim(P.MatMul)(False, False)/
  %3(CNode_394) = %2(%para21_input, %para22_other)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9665/        return _matmul(input, other)/
  Return(%3)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9665/        return _matmul(input, other)/
}
# Order:
#   1: @matmul_323:CNode_393{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.MatMul'}
#   2: @matmul_323:_matmul{[0]: CNode_393, [1]: ValueNode<BoolImm> false, [2]: ValueNode<BoolImm> false}
#   3: @matmul_323:CNode_394{[0]: _matmul, [1]: param_input, [2]: param_other}
#   4: @matmul_323:CNode_395{[0]: ValueNode<Primitive> Return, [1]: CNode_394}


subgraph attr:
subgraph instance: matmul_324 : 0x16df0710
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_324 parent: [subgraph @matmul_62]() {
  %1(CNode_397) = call @2matmul_396()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
}
# Order:
#   1: @matmul_324:CNode_397{[0]: ValueNode<FuncGraph> 2matmul_396}
#   2: @matmul_324:CNode_398{[0]: ValueNode<Primitive> Return, [1]: CNode_397}


subgraph attr:
subgraph instance: matmul_318 : 0x16def530
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_318 parent: [subgraph @matmul_234]() {
  %1(CNode_312) = $(matmul_234):S_Prim_Rank(%para21_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %2(CNode_313) = $(matmul_234):S_Prim_Rank(%para22_other)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %3(CNode_314) = $(matmul_234):S_Prim_MakeTuple(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %4(other_rank) = $(matmul_234):S_Prim_getitem(%3, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %5(CNode_399) = S_Prim_equal(%4, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
}
# Order:
#   1: @matmul_318:CNode_399{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: other_rank, [2]: ValueNode<Int64Imm> 2}
#   2: @matmul_318:CNode_400{[0]: ValueNode<Primitive> Return, [1]: CNode_399}


subgraph attr:
subgraph instance: matmul_319 : 0x16deeb30
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @matmul_319 parent: [subgraph @matmul_234]() {
  %1(CNode_312) = $(matmul_234):S_Prim_Rank(%para21_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %2(CNode_313) = $(matmul_234):S_Prim_Rank(%para22_other)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %3(CNode_314) = $(matmul_234):S_Prim_MakeTuple(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %4(input_rank) = $(matmul_234):S_Prim_getitem(%3, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9662/    input_rank, other_rank = rank_(input), rank_(other)/
  %5(CNode_315) = $(matmul_234):S_Prim_equal(%4, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9663/    if input_rank == 2 and other_rank == 2:/
}
# Order:
#   1: @matmul_319:CNode_401{[0]: ValueNode<Primitive> Return, [1]: CNode_315}


subgraph attr:
subgraph instance: sum_335 : 0x16dd5400
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @sum_335 parent: [subgraph @sum_47]() {
  %1(CNode_402) = S_Prim_MakeTuple("dim")
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  %2(CNode_403) = S_Prim_MakeTuple(%para24_dim)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  %3(CNode_404) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  %4(CNode_405) = PyInterpret[side_effect_io: Bool(1)](Script['f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}"'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  %5(CNode_406) = raise[side_effect_io: Bool(1)]("TypeError", %4, "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12013/        raise TypeError(f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}")/
}
# Order:
#   1: @sum_335:CNode_402{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> dim}
#   2: @sum_335:CNode_403{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_dim}
#   3: @sum_335:CNode_404{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_402, [2]: CNode_403}
#   4: @sum_335:CNode_405{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'f"For 'sum', 'dim' must be int, tuple(int), list(int) or None, but got {type(dim)}"', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'isinstance': <built-in function isinstance>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>, 'type': <class 'type'>, 'int': <class 'int'>, 'tuple': <class 'tuple'>, 'list': <class 'list'>}), [3]: CNode_404}
#   5: @sum_335:CNode_406{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: CNode_405, [3]: ValueNode<StringImm> None}
#   6: @sum_335:CNode_407{[0]: ValueNode<Primitive> Return, [1]: CNode_406}


subgraph attr:
subgraph instance: sum_336 : 0x16dbddd0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @sum_336 parent: [subgraph @sum_47]() {
  %1(CNode_409) = call @2sum_408()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
}
# Order:
#   1: @sum_336:CNode_409{[0]: ValueNode<FuncGraph> 2sum_408}
#   2: @sum_336:CNode_410{[0]: ValueNode<Primitive> Return, [1]: CNode_409}


subgraph attr:
subgraph instance: sum_330 : 0x16dbc5a0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @sum_330 parent: [subgraph @sum_47]() {
  %1(CNode_411) = S_Prim_MakeTuple(ClassType, ClassType, ClassType)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %2(CNode_412) = S_Prim_isinstance(%para24_dim, %1)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  %3(CNode_413) = S_Prim_logical_not(%2)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  Return(%3)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
}
# Order:
#   1: @sum_330:CNode_411{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<ClassType> class 'int', [2]: ValueNode<ClassType> class 'tuple', [3]: ValueNode<ClassType> class 'list'}
#   2: @sum_330:CNode_412{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_dim, [2]: CNode_411}
#   3: @sum_330:CNode_413{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_412}
#   4: @sum_330:CNode_414{[0]: ValueNode<Primitive> Return, [1]: CNode_413}


subgraph attr:
subgraph instance: sum_331 : 0x16dbbc40
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @sum_331 parent: [subgraph @sum_246]() {
  %1(CNode_327) = $(sum_246):S_Prim_is_not(%para24_dim, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12012/    if dim is not None and not isinstance(dim, (int, tuple, list)):/
}
# Order:
#   1: @sum_331:CNode_415{[0]: ValueNode<Primitive> Return, [1]: CNode_327}


subgraph attr:
subgraph instance: _new_prim_for_graph_20 : 0x16b68970
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:67/    def _new_prim_for_graph(*args, **kwargs) -> Primitive:/
subgraph @_new_prim_for_graph_20 parent: [subgraph @_get_cache_prim_19](%para61_args, %para62_kwargs) {
  %1(CNode_416) = UnpackCall_unpack_call(%para47_cls, %para61_args, %para62_kwargs)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:68/        return cls(*args, **kwargs)/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/_primitive_cache.py:68/        return cls(*args, **kwargs)/
}
# Order:
#   1: @_new_prim_for_graph_20:CNode_416{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.22, [1]: param_cls, [2]: param_args, [3]: param_kwargs}
#   2: @_new_prim_for_graph_20:CNode_417{[0]: ValueNode<Primitive> Return, [1]: CNode_416}


subgraph attr:
after_block : 1
subgraph instance: zeros_343 : 0x16d7c250
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @zeros_343(%para63_) {
  Return(%para63_size)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1036/    elif isinstance(size, list):/
}
# Order:
#   1: @zeros_343:CNode_418{[0]: ValueNode<Primitive> Return, [1]: param_size}


subgraph attr:
after_block : 1
subgraph instance: 2zeros_357 : 0x16d7ac90
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @2zeros_357(%para64_) {
  %1(CNode_419) = call @zeros_343(%para64_size)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:52/        min_encodings = ops.zeros(/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @2zeros_357:CNode_420{[0]: ValueNode<Primitive> Return, [1]: CNode_419}
#   2: @2zeros_357:CNode_419{[0]: ValueNode<FuncGraph> zeros_343, [1]: param_size}


subgraph attr:
subgraph instance: 2zeros_354 : 0x16d797a0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @2zeros_354 parent: [subgraph @zeros_75]() {
  %1(CNode_421) = getattr(%para33_size, "reshape")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1039/        size = size.reshape(1)/
  %2(size) = %1(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1039/        size = size.reshape(1)/
  Return(%2)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1039/        size = size.reshape(1)/
}
# Order:
#   1: @2zeros_354:CNode_421{[0]: ValueNode<Primitive> getattr, [1]: param_size, [2]: ValueNode<StringImm> reshape}
#   2: @2zeros_354:size{[0]: CNode_421, [1]: ValueNode<Int64Imm> 1}
#   3: @2zeros_354:CNode_422{[0]: ValueNode<Primitive> Return, [1]: size}


subgraph attr:
subgraph instance: 3zeros_355 : 0x16d78910
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @3zeros_355 parent: [subgraph @zeros_75]() {
  Return(%para33_size)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @3zeros_355:CNode_423{[0]: ValueNode<Primitive> Return, [1]: param_size}


subgraph attr:
subgraph instance: 2zeros_349 : 0x16d8a9b0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @2zeros_349 parent: [subgraph @zeros_75]() {
  %1(CNode_424) = getattr(%para33_size, "ndim")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %2(CNode_425) = S_Prim_equal(%1, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %3(CNode_426) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %4(CNode_427) = Switch(%3, @22zeros_428, @2zeros_429)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %5(CNode_430) = %4()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @2zeros_349:CNode_424{[0]: ValueNode<Primitive> getattr, [1]: param_size, [2]: ValueNode<StringImm> ndim}
#   2: @2zeros_349:CNode_425{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: CNode_424, [2]: ValueNode<Int64Imm> 0}
#   3: @2zeros_349:CNode_426{[0]: ValueNode<Primitive> Cond, [1]: CNode_425, [2]: ValueNode<BoolImm> false}
#   4: @2zeros_349:CNode_427{[0]: ValueNode<Primitive> Switch, [1]: CNode_426, [2]: ValueNode<FuncGraph> 22zeros_428, [3]: ValueNode<FuncGraph> 2zeros_429}
#   5: @2zeros_349:CNode_430{[0]: CNode_427}
#   6: @2zeros_349:CNode_431{[0]: ValueNode<Primitive> Return, [1]: CNode_430}


subgraph attr:
subgraph instance: 2zeros_350 : 0x16aaefc0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @2zeros_350 parent: [subgraph @2zeros_267]() {
  %1(CNode_346) = $(2zeros_267):S_Prim_isinstance(%para33_size, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @2zeros_350:CNode_432{[0]: ValueNode<Primitive> Return, [1]: CNode_346}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_360 : 0x16d48be0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_360 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_273]() {
  %1(output) = $(mindspore_nn_layer_conv_Conv2d_construct_273):S_Prim_Conv2D[kernel_size: (I64(4), I64(4)), mode: I64(1), out_channel: I64(64), input_names: ["x", "w"], pad: (I64(1), I64(1), I64(1), I64(1)), pad_mode: I64(0), format: "NCHW", pad_list: (I64(1), I64(1), I64(1), I64(1)), groups: I64(1), stride: (I64(1), I64(1), I64(2), I64(2)), group: I64(1), dilation: (I64(1), I64(1), I64(1), I64(1)), output_names: ["output"]](%para50_x, %para4_encoder.conv_stack.0.weight)
      : (<null>, <Ref[Tensor[Float32]], (64, 3, 4, 4), ref_key=:encoder.conv_stack.0.weight>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/0-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:361/        output = self.conv2d(x, self.weight)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/0-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:364/        return output/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_360:CNode_433{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_363 : 0x16bd86d0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_363 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_280]() {
  %1(output) = $(mindspore_nn_layer_conv_Conv2d_construct_280):S_Prim_Conv2D[kernel_size: (I64(4), I64(4)), mode: I64(1), out_channel: I64(128), input_names: ["x", "w"], pad: (I64(1), I64(1), I64(1), I64(1)), pad_mode: I64(0), format: "NCHW", pad_list: (I64(1), I64(1), I64(1), I64(1)), groups: I64(1), stride: (I64(1), I64(1), I64(2), I64(2)), group: I64(1), dilation: (I64(1), I64(1), I64(1), I64(1)), output_names: ["output"]](%para52_x, %para5_encoder.conv_stack.2.weight)
      : (<null>, <Ref[Tensor[Float32]], (128, 64, 4, 4), ref_key=:encoder.conv_stack.2.weight>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/2-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:361/        output = self.conv2d(x, self.weight)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/2-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:364/        return output/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_363:CNode_434{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_366 : 0x16c39260
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_366 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_287]() {
  %1(output) = $(mindspore_nn_layer_conv_Conv2d_construct_287):S_Prim_Conv2D[kernel_size: (I64(3), I64(3)), mode: I64(1), out_channel: I64(128), input_names: ["x", "w"], pad: (I64(1), I64(1), I64(1), I64(1)), pad_mode: I64(0), format: "NCHW", pad_list: (I64(1), I64(1), I64(1), I64(1)), groups: I64(1), stride: (I64(1), I64(1), I64(1), I64(1)), group: I64(1), dilation: (I64(1), I64(1), I64(1), I64(1)), output_names: ["output"]](%para54_x, %para6_encoder.conv_stack.4.weight)
      : (<null>, <Ref[Tensor[Float32]], (128, 128, 3, 3), ref_key=:encoder.conv_stack.4.weight>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/4-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:361/        output = self.conv2d(x, self.weight)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/4-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:364/        return output/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_366:CNode_435{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
subgraph instance: mindspore_nn_layer_container_SequentialCell_construct_370 : 0x16a6f090
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
subgraph @mindspore_nn_layer_container_SequentialCell_construct_370 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para65_input_data) {
  %1(CNode_437) = call @mindspore_nn_layer_container_SequentialCell_construct_436(I64(0), %para65_input_data)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
}
# Order:
#   1: @mindspore_nn_layer_container_SequentialCell_construct_370:CNode_438{[0]: ValueNode<DoSignaturePrimitive> S_Prim_inner_len, [1]: CNode_439}
#   2: @mindspore_nn_layer_container_SequentialCell_construct_370:CNode_437{[0]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_436, [1]: ValueNode<Int64Imm> 0, [2]: param_input_data}
#   3: @mindspore_nn_layer_container_SequentialCell_construct_370:CNode_440{[0]: ValueNode<Primitive> Return, [1]: CNode_437}


subgraph attr:
subgraph instance: videogvt_models_vqvae_residual_ResidualStack_construct_376 : 0x16c3a9f0
# In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:46/    def construct(self, x):/
subgraph @videogvt_models_vqvae_residual_ResidualStack_construct_376 parent: [subgraph @videogvt_models_vqvae_residual_ResidualStack_construct_292]() {
  %1(CNode_374) = MultitypeFuncGraph_add{(COOTensor, COOTensor), (CSRTensor, CSRTensor), (Number, Number), (String, String), (Tensor, List), (Tuple, Tuple), (Dictionary, Dictionary), (Tensor, Number), (Number, Tensor), (Tuple, Tensor), (Tensor, Tuple), (COOTensor, Tensor), (List, List), (Tensor, COOTensor), (Tensor, Tensor), (List, Tensor), (RowTensor, Tensor), (NoneType, NoneType)}(%para59_@CNode_374, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  %2(CNode_441) = StopGradient(%1)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:46/    def construct(self, x):/
  %3(CNode_295) = $(videogvt_models_vqvae_residual_ResidualStack_construct_291):MakeTuple(@videogvt_models_vqvae_residual_ResidualLayer_construct_369, @videogvt_models_vqvae_residual_ResidualLayer_construct_369)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  %4(CNode_442) = call @ms_iter_3(%3)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  %5(layer) = S_Prim_getitem(%4, %para59_@CNode_374)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  %6(x) = %5(%para60_x)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:48/            x = layer(x)/
  %7(CNode_443) = call @videogvt_models_vqvae_residual_ResidualStack_construct_292(%1, %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %8(CNode_444) = Depend[side_effect_propagate: I64(1)](%7, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
  Return(%8)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:47/        for layer in self.stack:/
}
# Order:
#   1: @videogvt_models_vqvae_residual_ResidualStack_construct_376:CNode_442{[0]: ValueNode<FuncGraph> ms_iter_3, [1]: CNode_295}
#   2: @videogvt_models_vqvae_residual_ResidualStack_construct_376:layer{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_442, [2]: param_@CNode_374}
#   3: @videogvt_models_vqvae_residual_ResidualStack_construct_376:CNode_374{[0]: ValueNode<MultitypeFuncGraph> MetaFuncGraph-add.4, [1]: param_@CNode_374, [2]: ValueNode<Int64Imm> 1}
#   4: @videogvt_models_vqvae_residual_ResidualStack_construct_376:x{[0]: layer, [1]: param_x}
#   5: @videogvt_models_vqvae_residual_ResidualStack_construct_376:CNode_445{[0]: ValueNode<Primitive> Return, [1]: CNode_444}
#   6: @videogvt_models_vqvae_residual_ResidualStack_construct_376:CNode_443{[0]: ValueNode<FuncGraph> videogvt_models_vqvae_residual_ResidualStack_construct_292, [1]: CNode_374, [2]: x}


subgraph attr:
subgraph instance: videogvt_models_vqvae_residual_ResidualStack_construct_377 : 0x16cf6370
# In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:46/    def construct(self, x):/
subgraph @videogvt_models_vqvae_residual_ResidualStack_construct_377 parent: [subgraph @videogvt_models_vqvae_residual_ResidualStack_construct_292]() {
  %1(x) = call @relu_446(%para60_x)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:49/        x = ops.relu(x)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/residual.py:50/        return x/
}
# Order:
#   1: @videogvt_models_vqvae_residual_ResidualStack_construct_377:x{[0]: ValueNode<FuncGraph> relu_446, [1]: param_x}
#   2: @videogvt_models_vqvae_residual_ResidualStack_construct_377:CNode_447{[0]: ValueNode<Primitive> Return, [1]: x}


subgraph attr:
subgraph instance: ms_iter_3 : 0x16bf4550
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/_extends/parse/standard_method.py:2345/def ms_iter(xs):/
subgraph @ms_iter_3(%para66_xs) {
  %1(CNode_448) = getattr(%para66_xs, "__ms_iter__")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/_extends/parse/standard_method.py:2347/    return xs.__ms_iter__/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/_extends/parse/standard_method.py:2347/    return xs.__ms_iter__/
}
# Order:
#   1: @ms_iter_3:CNode_448{[0]: ValueNode<Primitive> getattr, [1]: param_xs, [2]: ValueNode<StringImm> __ms_iter__}
#   2: @ms_iter_3:CNode_449{[0]: ValueNode<Primitive> Return, [1]: CNode_448}


subgraph attr:
after_block : 1
subgraph instance: 2argmin_388 : 0x16da61b0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @2argmin_388 parent: [subgraph @argmin_70](%para67_, %para68_, %para69_) {
  %1(CNode_450) = Cond(%para20_keepdims, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %2(CNode_451) = Switch(%1, @2argmin_452, @2argmin_453)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %3(CNode_454) = %2()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %4(CNode_455) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %5(CNode_456) = Switch(%4, @2argmin_457, @2argmin_458)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %6(CNode_459) = %5()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  %7(CNode_461) = call @3argmin_460(%6)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:51/        min_encoding_indices = ops.argmin(d, axis=1).unsqueeze(1)/
  Return(%7)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
}
# Order:
#   1: @2argmin_388:CNode_462{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.array_ops.Argmin'}
#   2: @2argmin_388:CNode_463{[0]: CNode_462, [1]: param_axis}
#   3: @2argmin_388:out{[0]: CNode_463, [1]: param_input}
#   4: @2argmin_388:CNode_450{[0]: ValueNode<Primitive> Cond, [1]: param_keepdims, [2]: ValueNode<BoolImm> false}
#   5: @2argmin_388:CNode_451{[0]: ValueNode<Primitive> Switch, [1]: CNode_450, [2]: ValueNode<FuncGraph> 2argmin_452, [3]: ValueNode<FuncGraph> 2argmin_453}
#   6: @2argmin_388:CNode_454{[0]: CNode_451}
#   7: @2argmin_388:CNode_455{[0]: ValueNode<Primitive> Cond, [1]: CNode_454, [2]: ValueNode<BoolImm> false}
#   8: @2argmin_388:CNode_456{[0]: ValueNode<Primitive> Switch, [1]: CNode_455, [2]: ValueNode<FuncGraph> 2argmin_457, [3]: ValueNode<FuncGraph> 2argmin_458}
#   9: @2argmin_388:CNode_459{[0]: CNode_456}
#  10: @2argmin_388:CNode_461{[0]: ValueNode<FuncGraph> 3argmin_460, [1]: CNode_459}
#  11: @2argmin_388:CNode_464{[0]: ValueNode<Primitive> Return, [1]: CNode_461}


subgraph attr:
after_block : 1
subgraph instance: 2matmul_396 : 0x16df1f50
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @2matmul_396 parent: [subgraph @matmul_62]() {
  %1(other) = S_Prim__expand[constexpr_prim: Bool(1)](%para22_other, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9679/    other = _expand(other, 2)/
  %2(CNode_465) = S_Prim_Rank(%1)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %3(CNode_466) = S_Prim_equal(%2, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %4(CNode_467) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %5(CNode_468) = Switch(%4, @2matmul_469, @2matmul_470)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %6(CNode_471) = %5()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
  %7(CNode_473) = call @3matmul_472(%6)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:48/            ops.matmul(z_flattened, self.embedding.embedding_table.value().t())/
  Return(%7)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9680/    if rank_(other) == 2:/
}
# Order:
#   1: @2matmul_396:CNode_474{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: param_input}
#   2: @2matmul_396:CNode_475{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: param_other}
#   3: @2matmul_396:CNode_476{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_474, [2]: CNode_475}
#   4: @2matmul_396:ndim1_orig{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_476, [2]: ValueNode<Int64Imm> 0}
#   5: @2matmul_396:ndim2_orig{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_476, [2]: ValueNode<Int64Imm> 1}
#   6: @2matmul_396:CNode_477{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Shape, [1]: param_input}
#   7: @2matmul_396:CNode_478{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Shape, [1]: param_other}
#   8: @2matmul_396:CNode_479{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_477, [2]: CNode_478}
#   9: @2matmul_396:shape1_orig{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_479, [2]: ValueNode<Int64Imm> 0}
#  10: @2matmul_396:shape2_orig{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_479, [2]: ValueNode<Int64Imm> 1}
#  11: @2matmul_396:transpose_b{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: ndim2_orig, [2]: ValueNode<Int64Imm> 1}
#  12: @2matmul_396:shape_backbone{[0]: ValueNode<DoSignaturePrimitive> S_Prim__check_matmul_shapes, [1]: shape1_orig, [2]: shape2_orig, [3]: ValueNode<StringImm> matmul}
#  13: @2matmul_396:CNode_480{[0]: ValueNode<DoSignaturePrimitive> S_Prim__infer_shape_rem, [1]: shape1_orig, [2]: shape2_orig, [3]: ndim1_orig, [4]: ndim2_orig, [5]: transpose_b}
#  14: @2matmul_396:shape_out{[0]: ValueNode<DoSignaturePrimitive> S_Prim_add, [1]: shape_backbone, [2]: CNode_480}
#  15: @2matmul_396:CNode_481{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.MatMul'}
#  16: @2matmul_396:_matmul{[0]: CNode_481, [1]: ValueNode<BoolImm> false, [2]: transpose_b}
#  17: @2matmul_396:CNode_482{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.BatchMatMul'}
#  18: @2matmul_396:_batch_matmul{[0]: CNode_482, [1]: ValueNode<BoolImm> false, [2]: transpose_b}
#  19: @2matmul_396:input{[0]: ValueNode<DoSignaturePrimitive> S_Prim__expand, [1]: param_input, [2]: ValueNode<Int64Imm> 2}
#  20: @2matmul_396:other{[0]: ValueNode<DoSignaturePrimitive> S_Prim__expand, [1]: param_other, [2]: ValueNode<Int64Imm> 2}
#  21: @2matmul_396:CNode_465{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: other}
#  22: @2matmul_396:CNode_466{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: CNode_465, [2]: ValueNode<Int64Imm> 2}
#  23: @2matmul_396:CNode_467{[0]: ValueNode<Primitive> Cond, [1]: CNode_466, [2]: ValueNode<BoolImm> false}
#  24: @2matmul_396:CNode_468{[0]: ValueNode<Primitive> Switch, [1]: CNode_467, [2]: ValueNode<FuncGraph> 2matmul_469, [3]: ValueNode<FuncGraph> 2matmul_470}
#  25: @2matmul_396:CNode_471{[0]: CNode_468}
#  26: @2matmul_396:CNode_473{[0]: ValueNode<FuncGraph> 3matmul_472, [1]: CNode_471}
#  27: @2matmul_396:CNode_483{[0]: ValueNode<Primitive> Return, [1]: CNode_473}


subgraph attr:
after_block : 1
subgraph instance: 2sum_408 : 0x16dbf6a0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @2sum_408 parent: [subgraph @sum_47]() {
  %1(CNode_484) = S_Prim_isinstance(%para25_keepdim, ClassType)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  %2(CNode_485) = S_Prim_logical_not(%1)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  %3(CNode_486) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  %4(CNode_487) = Switch(%3, @2sum_488, @2sum_489)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  %5(CNode_490) = %4()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
}
# Order:
#   1: @2sum_408:CNode_484{[0]: ValueNode<DoSignaturePrimitive> S_Prim_isinstance, [1]: param_keepdim, [2]: ValueNode<ClassType> class 'bool'}
#   2: @2sum_408:CNode_485{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: CNode_484}
#   3: @2sum_408:CNode_486{[0]: ValueNode<Primitive> Cond, [1]: CNode_485, [2]: ValueNode<BoolImm> false}
#   4: @2sum_408:CNode_487{[0]: ValueNode<Primitive> Switch, [1]: CNode_486, [2]: ValueNode<FuncGraph> 2sum_488, [3]: ValueNode<FuncGraph> 2sum_489}
#   5: @2sum_408:CNode_490{[0]: CNode_487}
#   6: @2sum_408:CNode_491{[0]: ValueNode<Primitive> Return, [1]: CNode_490}


subgraph attr:
subgraph instance: 22zeros_428 : 0x16d8d970
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @22zeros_428 parent: [subgraph @zeros_75]() {
  %1(CNode_492) = getattr(%para33_size, "size")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %2(CNode_493) = S_Prim_equal(%1, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  Return(%2)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @22zeros_428:CNode_492{[0]: ValueNode<Primitive> getattr, [1]: param_size, [2]: ValueNode<StringImm> size}
#   2: @22zeros_428:CNode_493{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: CNode_492, [2]: ValueNode<Int64Imm> 1}
#   3: @22zeros_428:CNode_494{[0]: ValueNode<Primitive> Return, [1]: CNode_493}


subgraph attr:
subgraph instance: 2zeros_429 : 0x16d8cad0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1003/def zeros(size, dtype=None):  # pylint: disable=redefined-outer-name/
subgraph @2zeros_429 parent: [subgraph @2zeros_349]() {
  %1(CNode_424) = $(2zeros_349):getattr(%para33_size, "ndim")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  %2(CNode_425) = $(2zeros_349):S_Prim_equal(%1, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
  Return(%2)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/array_func.py:1038/    elif isinstance(size, Tensor) and size.ndim == 0 and size.size == 1:/
}
# Order:
#   1: @2zeros_429:CNode_495{[0]: ValueNode<Primitive> Return, [1]: CNode_425}


subgraph attr:
subgraph instance: mindspore_nn_layer_activation_ReLU_construct_496 : 0x16c2b540
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:437/    def construct(self, x):/
subgraph @mindspore_nn_layer_activation_ReLU_construct_496(%para70_x) {
  %1(CNode_497) = S_Prim_ReLU[output_names: ["output"], input_names: ["x"]](%para70_x)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/0-ReLU)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:438/        return self.relu(x)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/0-ReLU)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:438/        return self.relu(x)/
}
# Order:
#   1: @mindspore_nn_layer_activation_ReLU_construct_496:CNode_497{[0]: ValueNode<DoSignaturePrimitive> S_Prim_ReLU, [1]: param_x}
#   2: @mindspore_nn_layer_activation_ReLU_construct_496:CNode_498{[0]: ValueNode<Primitive> Return, [1]: CNode_497}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_499 : 0x16d46e00
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_499 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para71_x) {
  %1(CNode_501) = call @mindspore_nn_layer_conv_Conv2d_construct_500()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/1-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/1-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_499:output{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Conv2D, [1]: param_x, [2]: param_encoder.conv_stack.5.stack.0.res_block.1.weight}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_499:CNode_501{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_500}
#   3: @mindspore_nn_layer_conv_Conv2d_construct_499:CNode_502{[0]: ValueNode<Primitive> Return, [1]: CNode_501}


subgraph attr:
subgraph instance: mindspore_nn_layer_activation_ReLU_construct_503 : 0x16c79500
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:437/    def construct(self, x):/
subgraph @mindspore_nn_layer_activation_ReLU_construct_503(%para72_x) {
  %1(CNode_504) = S_Prim_ReLU[output_names: ["output"], input_names: ["x"]](%para72_x)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/2-ReLU)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:438/        return self.relu(x)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/2-ReLU)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/activation.py:438/        return self.relu(x)/
}
# Order:
#   1: @mindspore_nn_layer_activation_ReLU_construct_503:CNode_504{[0]: ValueNode<DoSignaturePrimitive> S_Prim_ReLU, [1]: param_x}
#   2: @mindspore_nn_layer_activation_ReLU_construct_503:CNode_505{[0]: ValueNode<Primitive> Return, [1]: CNode_504}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_506 : 0x16c28080
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_506 parent: [subgraph @videogvt_models_vqvae_vqvae_VQVAE_construct_23](%para73_x) {
  %1(CNode_508) = call @mindspore_nn_layer_conv_Conv2d_construct_507()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/3-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/3-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_506:output{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Conv2D, [1]: param_x, [2]: param_encoder.conv_stack.5.stack.0.res_block.3.weight}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_506:CNode_508{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_507}
#   3: @mindspore_nn_layer_conv_Conv2d_construct_506:CNode_509{[0]: ValueNode<Primitive> Return, [1]: CNode_508}


subgraph attr:
subgraph instance: mindspore_nn_layer_container_SequentialCell_construct_436 : 0x16b649a0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
subgraph @mindspore_nn_layer_container_SequentialCell_construct_436 parent: [subgraph @mindspore_nn_layer_container_SequentialCell_construct_370](%para74_, %para75_) {
  %1(CNode_439) = $(mindspore_nn_layer_container_SequentialCell_construct_370):MakeTuple(@mindspore_nn_layer_activation_ReLU_construct_496, @mindspore_nn_layer_conv_Conv2d_construct_499, @mindspore_nn_layer_activation_ReLU_construct_503, @mindspore_nn_layer_conv_Conv2d_construct_506)
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %2(CNode_438) = $(mindspore_nn_layer_container_SequentialCell_construct_370):S_Prim_inner_len(%1)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %3(CNode_510) = MultitypeFuncGraph_less{(List, List), (Tensor, Number), (Tensor, Tensor), (Tuple, Tuple), (Number, Tensor), (String, String), (Number, Number)}(%para74_@CNode_511, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %4(CNode_512) = Switch(%3, @mindspore_nn_layer_container_SequentialCell_construct_513, @mindspore_nn_layer_container_SequentialCell_construct_514)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %5(CNode_515) = %4()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  Return(%5)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
}
# Order:
#   1: @mindspore_nn_layer_container_SequentialCell_construct_436:CNode_510{[0]: ValueNode<MultitypeFuncGraph> MetaFuncGraph-less.303, [1]: param_@CNode_511, [2]: CNode_438}
#   2: @mindspore_nn_layer_container_SequentialCell_construct_436:CNode_512{[0]: ValueNode<Primitive> Switch, [1]: CNode_510, [2]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_513, [3]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_514}
#   3: @mindspore_nn_layer_container_SequentialCell_construct_436:CNode_515{[0]: CNode_512}
#   4: @mindspore_nn_layer_container_SequentialCell_construct_436:CNode_516{[0]: ValueNode<Primitive> Return, [1]: CNode_515}


subgraph attr:
subgraph instance: relu_446 : 0x16cde320
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:3420/def relu(input):/
subgraph @relu_446(%para76_input) {
  %1(CNode_517) = call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:3458/    relu_ = _get_cache_prim(NN_OPS.ReLU)()/
  %2(relu_) = %1()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:3458/    relu_ = _get_cache_prim(NN_OPS.ReLU)()/
  %3(CNode_518) = %2(%para76_input)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:3459/    return relu_(input)/
  Return(%3)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/nn_func.py:3459/    return relu_(input)/
}
# Order:
#   1: @relu_446:CNode_517{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.nn_ops.ReLU'}
#   2: @relu_446:relu_{[0]: CNode_517}
#   3: @relu_446:CNode_518{[0]: relu_, [1]: param_input}
#   4: @relu_446:CNode_519{[0]: ValueNode<Primitive> Return, [1]: CNode_518}


subgraph attr:
after_block : 1
subgraph instance: 3argmin_460 : 0x16dadf20
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @3argmin_460(%para77_) {
  Return(%para77_out)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:673/    return out/
}
# Order:
#   1: @3argmin_460:CNode_520{[0]: ValueNode<Primitive> Return, [1]: param_out}


subgraph attr:
subgraph instance: 2argmin_457 : 0x16dacd40
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @2argmin_457 parent: [subgraph @2argmin_388]() {
  %1(CNode_462) = $(2argmin_388):call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %2(CNode_463) = $(2argmin_388):%1(%para67_axis)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %3(out) = $(2argmin_388):%2(%para68_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %4(out) = S_Prim_ExpandDims[output_names: ["output"], input_names: ["x", "axis"]](%3, %para67_axis)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:672/        out = expand_dims_(out, axis)/
  Return(%4)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:672/        out = expand_dims_(out, axis)/
}
# Order:
#   1: @2argmin_457:out{[0]: ValueNode<DoSignaturePrimitive> S_Prim_ExpandDims, [1]: out, [2]: param_axis}
#   2: @2argmin_457:CNode_521{[0]: ValueNode<Primitive> Return, [1]: out}


subgraph attr:
subgraph instance: 2argmin_458 : 0x16dabea0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @2argmin_458 parent: [subgraph @2argmin_388]() {
  %1(CNode_462) = $(2argmin_388):call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %2(CNode_463) = $(2argmin_388):%1(%para67_axis)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  %3(out) = $(2argmin_388):%2(%para68_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:670/    out = _get_cache_prim(P.Argmin)(axis)(input)/
  Return(%3)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
}
# Order:
#   1: @2argmin_458:CNode_522{[0]: ValueNode<Primitive> Return, [1]: out}


subgraph attr:
subgraph instance: 2argmin_452 : 0x16daace0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @2argmin_452 parent: [subgraph @2argmin_388]() {
  %1(CNode_523) = S_Prim_logical_not(%para69_is_axis_none)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
}
# Order:
#   1: @2argmin_452:CNode_523{[0]: ValueNode<DoSignaturePrimitive> S_Prim_logical_not, [1]: param_is_axis_none}
#   2: @2argmin_452:CNode_524{[0]: ValueNode<Primitive> Return, [1]: CNode_523}


subgraph attr:
subgraph instance: 2argmin_453 : 0x16da9f80
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:632/def argmin(input, axis=None, keepdims=False):/
subgraph @2argmin_453 parent: [subgraph @argmin_70]() {
  Return(%para20_keepdims)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:671/    if keepdims and not is_axis_none:/
}
# Order:
#   1: @2argmin_453:CNode_525{[0]: ValueNode<Primitive> Return, [1]: param_keepdims}


subgraph attr:
after_block : 1
subgraph instance: 3matmul_472 : 0x16e06d00
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @3matmul_472 parent: [subgraph @2matmul_396](%para78_) {
  %1(CNode_477) = $(2matmul_396):S_Prim_Shape(%para21_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %2(CNode_478) = $(2matmul_396):S_Prim_Shape(%para22_other)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %3(CNode_479) = $(2matmul_396):S_Prim_MakeTuple(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %4(shape1_orig) = $(2matmul_396):S_Prim_getitem(%3, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %5(shape2_orig) = $(2matmul_396):S_Prim_getitem(%3, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %6(shape_backbone) = $(2matmul_396):S_Prim__check_matmul_shapes[constexpr_prim: Bool(1)](%4, %5, "matmul")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9670/    shape_backbone = _check_matmul_shapes(shape1_orig, shape2_orig, 'matmul')/
  %7(CNode_474) = $(2matmul_396):S_Prim_Rank(%para21_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %8(CNode_475) = $(2matmul_396):S_Prim_Rank(%para22_other)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %9(CNode_476) = $(2matmul_396):S_Prim_MakeTuple(%7, %8)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %10(ndim1_orig) = $(2matmul_396):S_Prim_getitem(%9, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %11(ndim2_orig) = $(2matmul_396):S_Prim_getitem(%9, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %12(transpose_b) = $(2matmul_396):S_Prim_equal(%11, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9669/    transpose_b = ndim2_orig == 1/
  %13(CNode_480) = $(2matmul_396):S_Prim__infer_shape_rem[constexpr_prim: Bool(1)](%4, %5, %10, %11, %12)
      : (<null>, <null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9672/    shape_out = shape_backbone + _infer_shape_rem(shape1_orig, shape2_orig,/
  %14(shape_out) = $(2matmul_396):S_Prim_add(%6, %13)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9672/    shape_out = shape_backbone + _infer_shape_rem(shape1_orig, shape2_orig,/
  %15(CNode_526) = S_Prim_Reshape[output_names: ["output"], input_names: ["tensor", "shape"]](%para78_res, %14)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9694/    return reshape_(res, shape_out)/
  Return(%15)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9694/    return reshape_(res, shape_out)/
}
# Order:
#   1: @3matmul_472:CNode_526{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Reshape, [1]: param_res, [2]: shape_out}
#   2: @3matmul_472:CNode_527{[0]: ValueNode<Primitive> Return, [1]: CNode_526}


subgraph attr:
subgraph instance: 2matmul_469 : 0x16e00790
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @2matmul_469 parent: [subgraph @2matmul_396]() {
  %1(input) = $(2matmul_396):S_Prim__expand[constexpr_prim: Bool(1)](%para21_input, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9678/    input = _expand(input, 2)/
  %2(CNode_528) = S_Prim_Rank(%1)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %3(CNode_529) = S_Prim_greater(%2, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %4(CNode_530) = Cond(%3, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %5(CNode_531) = Switch(%4, @22matmul_532, @2matmul_533)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %6(CNode_534) = %5()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
  %7(CNode_536) = call @2matmul_535(%6)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:48/            ops.matmul(z_flattened, self.embedding.embedding_table.value().t())/
  Return(%7)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
}
# Order:
#   1: @2matmul_469:CNode_528{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Rank, [1]: input}
#   2: @2matmul_469:CNode_529{[0]: ValueNode<DoSignaturePrimitive> S_Prim_greater, [1]: CNode_528, [2]: ValueNode<Int64Imm> 2}
#   3: @2matmul_469:CNode_530{[0]: ValueNode<Primitive> Cond, [1]: CNode_529, [2]: ValueNode<BoolImm> false}
#   4: @2matmul_469:CNode_531{[0]: ValueNode<Primitive> Switch, [1]: CNode_530, [2]: ValueNode<FuncGraph> 22matmul_532, [3]: ValueNode<FuncGraph> 2matmul_533}
#   5: @2matmul_469:CNode_534{[0]: CNode_531}
#   6: @2matmul_469:CNode_536{[0]: ValueNode<FuncGraph> 2matmul_535, [1]: CNode_534}
#   7: @2matmul_469:CNode_537{[0]: ValueNode<Primitive> Return, [1]: CNode_536}


subgraph attr:
subgraph instance: 2matmul_470 : 0x16df9100
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @2matmul_470 parent: [subgraph @2matmul_396]() {
  %1(CNode_482) = $(2matmul_396):call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9676/    _batch_matmul = _get_cache_prim(P.BatchMatMul)(False, transpose_b)/
  %2(CNode_474) = $(2matmul_396):S_Prim_Rank(%para21_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %3(CNode_475) = $(2matmul_396):S_Prim_Rank(%para22_other)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %4(CNode_476) = $(2matmul_396):S_Prim_MakeTuple(%2, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %5(ndim2_orig) = $(2matmul_396):S_Prim_getitem(%4, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %6(transpose_b) = $(2matmul_396):S_Prim_equal(%5, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9669/    transpose_b = ndim2_orig == 1/
  %7(_batch_matmul) = $(2matmul_396):%1(Bool(0), %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9676/    _batch_matmul = _get_cache_prim(P.BatchMatMul)(False, transpose_b)/
  %8(input) = $(2matmul_396):S_Prim__expand[constexpr_prim: Bool(1)](%para21_input, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9678/    input = _expand(input, 2)/
  %9(ndim1_orig) = $(2matmul_396):S_Prim_getitem(%4, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %10(ndim_aligned) = S_Prim__max[constexpr_prim: Bool(1)](%9, %5)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9686/        ndim_aligned = _max(ndim1_orig, ndim2_orig)/
  %11(input) = S_Prim__expand[constexpr_prim: Bool(1)](%8, %10)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9687/        input = _expand(input, ndim_aligned)/
  %12(CNode_538) = S_Prim_Shape(%11)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %13(other) = $(2matmul_396):S_Prim__expand[constexpr_prim: Bool(1)](%para22_other, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9679/    other = _expand(other, 2)/
  %14(other) = S_Prim__expand[constexpr_prim: Bool(1)](%13, %10)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9688/        other = _expand(other, ndim_aligned)/
  %15(CNode_539) = S_Prim_Shape(%14)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %16(CNode_540) = S_Prim_MakeTuple(%12, %15)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %17(shape1_aligned) = S_Prim_getitem(%16, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %18(CNode_541) = S_Prim_negative(I64(2))
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9690/        input = _broadcast_to(input, shape1_aligned[:-2], shape_backbone, ndim_aligned)/
  %19(CNode_542) = S_Prim_make_slice(None, %18, None)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9690/        input = _broadcast_to(input, shape1_aligned[:-2], shape_backbone, ndim_aligned)/
  %20(CNode_543) = S_Prim_getitem(%17, %19)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9690/        input = _broadcast_to(input, shape1_aligned[:-2], shape_backbone, ndim_aligned)/
  %21(CNode_477) = $(2matmul_396):S_Prim_Shape(%para21_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %22(CNode_478) = $(2matmul_396):S_Prim_Shape(%para22_other)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %23(CNode_479) = $(2matmul_396):S_Prim_MakeTuple(%21, %22)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %24(shape1_orig) = $(2matmul_396):S_Prim_getitem(%23, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %25(shape2_orig) = $(2matmul_396):S_Prim_getitem(%23, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %26(shape_backbone) = $(2matmul_396):S_Prim__check_matmul_shapes[constexpr_prim: Bool(1)](%24, %25, "matmul")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9670/    shape_backbone = _check_matmul_shapes(shape1_orig, shape2_orig, 'matmul')/
  %27(input) = call @_broadcast_to_544(%11, %20, %26, %10)
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9690/        input = _broadcast_to(input, shape1_aligned[:-2], shape_backbone, ndim_aligned)/
  %28(shape2_aligned) = S_Prim_getitem(%16, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9689/        shape1_aligned, shape2_aligned = shape_(input), shape_(other)/
  %29(CNode_545) = S_Prim_negative(I64(2))
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9691/        other = _broadcast_to(other, shape2_aligned[:-2], shape_backbone, ndim_aligned)/
  %30(CNode_546) = S_Prim_make_slice(None, %29, None)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9691/        other = _broadcast_to(other, shape2_aligned[:-2], shape_backbone, ndim_aligned)/
  %31(CNode_547) = S_Prim_getitem(%28, %30)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9691/        other = _broadcast_to(other, shape2_aligned[:-2], shape_backbone, ndim_aligned)/
  %32(other) = call @_broadcast_to_544(%14, %31, %26, %10)
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9691/        other = _broadcast_to(other, shape2_aligned[:-2], shape_backbone, ndim_aligned)/
  %33(res) = %7(%27, %32)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9692/        res = _batch_matmul(input, other)/
  Return(%33)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9686/        ndim_aligned = _max(ndim1_orig, ndim2_orig)/
}
# Order:
#   1: @2matmul_470:ndim_aligned{[0]: ValueNode<DoSignaturePrimitive> S_Prim__max, [1]: ndim1_orig, [2]: ndim2_orig}
#   2: @2matmul_470:input{[0]: ValueNode<DoSignaturePrimitive> S_Prim__expand, [1]: input, [2]: ndim_aligned}
#   3: @2matmul_470:other{[0]: ValueNode<DoSignaturePrimitive> S_Prim__expand, [1]: other, [2]: ndim_aligned}
#   4: @2matmul_470:CNode_538{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Shape, [1]: input}
#   5: @2matmul_470:CNode_539{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Shape, [1]: other}
#   6: @2matmul_470:CNode_540{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_538, [2]: CNode_539}
#   7: @2matmul_470:shape1_aligned{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_540, [2]: ValueNode<Int64Imm> 0}
#   8: @2matmul_470:shape2_aligned{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_540, [2]: ValueNode<Int64Imm> 1}
#   9: @2matmul_470:CNode_541{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 2}
#  10: @2matmul_470:CNode_542{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_slice, [1]: ValueNode<None> None, [2]: CNode_541, [3]: ValueNode<None> None}
#  11: @2matmul_470:CNode_543{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: shape1_aligned, [2]: CNode_542}
#  12: @2matmul_470:input{[0]: ValueNode<FuncGraph> _broadcast_to_544, [1]: input, [2]: CNode_543, [3]: shape_backbone, [4]: ndim_aligned}
#  13: @2matmul_470:CNode_545{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 2}
#  14: @2matmul_470:CNode_546{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_slice, [1]: ValueNode<None> None, [2]: CNode_545, [3]: ValueNode<None> None}
#  15: @2matmul_470:CNode_547{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: shape2_aligned, [2]: CNode_546}
#  16: @2matmul_470:other{[0]: ValueNode<FuncGraph> _broadcast_to_544, [1]: other, [2]: CNode_547, [3]: shape_backbone, [4]: ndim_aligned}
#  17: @2matmul_470:res{[0]: _batch_matmul, [1]: input, [2]: other}
#  18: @2matmul_470:CNode_548{[0]: ValueNode<Primitive> Return, [1]: res}


subgraph attr:
subgraph instance: 2sum_488 : 0x16dd3580
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @2sum_488 parent: [subgraph @sum_47]() {
  %1(CNode_549) = S_Prim_MakeTuple("keepdim")
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  %2(CNode_550) = S_Prim_MakeTuple(%para25_keepdim)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  %3(CNode_551) = S_Prim_make_dict(%1, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  %4(CNode_552) = PyInterpret[side_effect_io: Bool(1)](Script['f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}"'], InterpretedObject, %3)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  %5(CNode_553) = raise[side_effect_io: Bool(1)]("TypeError", %4, "None")
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12015/        raise TypeError(f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}")/
}
# Order:
#   1: @2sum_488:CNode_549{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> keepdim}
#   2: @2sum_488:CNode_550{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_keepdim}
#   3: @2sum_488:CNode_551{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_549, [2]: CNode_550}
#   4: @2sum_488:CNode_552{[0]: ValueNode<Primitive> PyInterpret, [1]: ValueNode<Script> 'f"For 'sum', 'keepdim' must be bool, but got {type(keepdim)}"', [2]: ValueNode<InterpretedObject> PythonObject(type: <class 'dict'>, value: {'isinstance': <built-in function isinstance>, 'Tensor': <class 'mindspore.common.tensor.Tensor'>, 'type': <class 'type'>, 'int': <class 'int'>, 'tuple': <class 'tuple'>, 'list': <class 'list'>, 'bool': <class 'bool'>}), [3]: CNode_551}
#   5: @2sum_488:CNode_553{[0]: ValueNode<Primitive> raise, [1]: ValueNode<StringImm> TypeError, [2]: CNode_552, [3]: ValueNode<StringImm> None}
#   6: @2sum_488:CNode_554{[0]: ValueNode<Primitive> Return, [1]: CNode_553}


subgraph attr:
subgraph instance: 2sum_489 : 0x16dc1d00
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @2sum_489 parent: [subgraph @sum_47]() {
  %1(CNode_556) = call @3sum_555()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12014/    if not isinstance(keepdim, bool):/
}
# Order:
#   1: @2sum_489:CNode_556{[0]: ValueNode<FuncGraph> 3sum_555}
#   2: @2sum_489:CNode_557{[0]: ValueNode<Primitive> Return, [1]: CNode_556}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_500 : 0x16d5fe10
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_500 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_499]() {
  %1(CNode_559) = call @mindspore_nn_layer_conv_Conv2d_construct_558()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/1-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/1-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_500:CNode_559{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_558}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_500:CNode_560{[0]: ValueNode<Primitive> Return, [1]: CNode_559}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_507 : 0x16c6bdc0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_507 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_506]() {
  %1(CNode_562) = call @mindspore_nn_layer_conv_Conv2d_construct_561()
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/3-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/3-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:362/        if self.has_bias:/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_507:CNode_562{[0]: ValueNode<FuncGraph> mindspore_nn_layer_conv_Conv2d_construct_561}
#   2: @mindspore_nn_layer_conv_Conv2d_construct_507:CNode_563{[0]: ValueNode<Primitive> Return, [1]: CNode_562}


subgraph attr:
subgraph instance: mindspore_nn_layer_container_SequentialCell_construct_513 : 0x16ac4fe0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
subgraph @mindspore_nn_layer_container_SequentialCell_construct_513 parent: [subgraph @mindspore_nn_layer_container_SequentialCell_construct_436]() {
  %1(CNode_511) = MultitypeFuncGraph_add{(COOTensor, COOTensor), (CSRTensor, CSRTensor), (Number, Number), (String, String), (Tensor, List), (Tuple, Tuple), (Dictionary, Dictionary), (Tensor, Number), (Number, Tensor), (Tuple, Tensor), (Tensor, Tuple), (COOTensor, Tensor), (List, List), (Tensor, COOTensor), (Tensor, Tensor), (List, Tensor), (RowTensor, Tensor), (NoneType, NoneType)}(%para74_@CNode_511, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %2(CNode_564) = StopGradient(%1)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
  %3(CNode_439) = $(mindspore_nn_layer_container_SequentialCell_construct_370):MakeTuple(@mindspore_nn_layer_activation_ReLU_construct_496, @mindspore_nn_layer_conv_Conv2d_construct_499, @mindspore_nn_layer_activation_ReLU_construct_503, @mindspore_nn_layer_conv_Conv2d_construct_506)
      : (<null>, <null>, <null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %4(CNode_565) = call @ms_iter_3(%3)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %5(cell) = S_Prim_getitem(%4, %para74_@CNode_511)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %6(input_data) = %5(%para75_input_data)
      : (<null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:295/            input_data = cell(input_data)/
  %7(CNode_566) = call @mindspore_nn_layer_container_SequentialCell_construct_436(%1, %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  %8(CNode_567) = Depend[side_effect_propagate: I64(1)](%7, %2)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
  Return(%8)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:294/        for cell in self.cell_list:/
}
# Order:
#   1: @mindspore_nn_layer_container_SequentialCell_construct_513:CNode_565{[0]: ValueNode<FuncGraph> ms_iter_3, [1]: CNode_439}
#   2: @mindspore_nn_layer_container_SequentialCell_construct_513:cell{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: CNode_565, [2]: param_@CNode_511}
#   3: @mindspore_nn_layer_container_SequentialCell_construct_513:CNode_511{[0]: ValueNode<MultitypeFuncGraph> MetaFuncGraph-add.4, [1]: param_@CNode_511, [2]: ValueNode<Int64Imm> 1}
#   4: @mindspore_nn_layer_container_SequentialCell_construct_513:input_data{[0]: cell, [1]: param_input_data}
#   5: @mindspore_nn_layer_container_SequentialCell_construct_513:CNode_566{[0]: ValueNode<FuncGraph> mindspore_nn_layer_container_SequentialCell_construct_436, [1]: CNode_511, [2]: input_data}
#   6: @mindspore_nn_layer_container_SequentialCell_construct_513:CNode_568{[0]: ValueNode<Primitive> Return, [1]: CNode_567}


subgraph attr:
subgraph instance: mindspore_nn_layer_container_SequentialCell_construct_514 : 0x16d18fe0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:293/    def construct(self, input_data):/
subgraph @mindspore_nn_layer_container_SequentialCell_construct_514 parent: [subgraph @mindspore_nn_layer_container_SequentialCell_construct_436]() {
  Return(%para75_input_data)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/container.py:296/        return input_data/
}
# Order:
#   1: @mindspore_nn_layer_container_SequentialCell_construct_514:CNode_569{[0]: ValueNode<Primitive> Return, [1]: param_input_data}


subgraph attr:
after_block : 1
subgraph instance: 2matmul_535 : 0x16e05870
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @2matmul_535 parent: [subgraph @2matmul_396](%para79_) {
  %1(CNode_481) = $(2matmul_396):call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9675/    _matmul = _get_cache_prim(P.MatMul)(False, transpose_b)/
  %2(CNode_474) = $(2matmul_396):S_Prim_Rank(%para21_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %3(CNode_475) = $(2matmul_396):S_Prim_Rank(%para22_other)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %4(CNode_476) = $(2matmul_396):S_Prim_MakeTuple(%2, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %5(ndim2_orig) = $(2matmul_396):S_Prim_getitem(%4, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9667/    ndim1_orig, ndim2_orig = rank_(input), rank_(other)/
  %6(transpose_b) = $(2matmul_396):S_Prim_equal(%5, I64(1))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9669/    transpose_b = ndim2_orig == 1/
  %7(_matmul) = $(2matmul_396):%1(Bool(0), %6)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9675/    _matmul = _get_cache_prim(P.MatMul)(False, transpose_b)/
  %8(other) = $(2matmul_396):S_Prim__expand[constexpr_prim: Bool(1)](%para22_other, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9679/    other = _expand(other, 2)/
  %9(res) = %7(%para79_input, %8)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9683/        res = _matmul(input, other)/
  Return(%9)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
}
# Order:
#   1: @2matmul_535:res{[0]: _matmul, [1]: param_input, [2]: other}
#   2: @2matmul_535:CNode_570{[0]: ValueNode<Primitive> Return, [1]: res}


subgraph attr:
subgraph instance: 22matmul_532 : 0x16e03a00
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @22matmul_532 parent: [subgraph @2matmul_396]() {
  %1(input) = $(2matmul_396):S_Prim__expand[constexpr_prim: Bool(1)](%para21_input, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9678/    input = _expand(input, 2)/
  %2(CNode_571) = S_Prim_negative(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  %3(CNode_477) = $(2matmul_396):S_Prim_Shape(%para21_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %4(CNode_478) = $(2matmul_396):S_Prim_Shape(%para22_other)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %5(CNode_479) = $(2matmul_396):S_Prim_MakeTuple(%3, %4)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %6(shape1_orig) = $(2matmul_396):S_Prim_getitem(%5, I64(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9668/    shape1_orig, shape2_orig = shape_(input), shape_(other)/
  %7(CNode_572) = S_Prim_negative(I64(1))
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  %8(CNode_573) = S_Prim_getitem(%6, %7)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  %9(CNode_574) = S_Prim_MakeTuple(%2, %8)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  %10(input) = S_Prim_Reshape[output_names: ["output"], input_names: ["tensor", "shape"]](%1, %9)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
  Return(%10)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9682/            input = reshape_(input, (-1, shape1_orig[-1]))/
}
# Order:
#   1: @22matmul_532:CNode_571{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 1}
#   2: @22matmul_532:CNode_572{[0]: ValueNode<DoSignaturePrimitive> S_Prim_negative, [1]: ValueNode<Int64Imm> 1}
#   3: @22matmul_532:CNode_573{[0]: ValueNode<DoSignaturePrimitive> S_Prim_getitem, [1]: shape1_orig, [2]: CNode_572}
#   4: @22matmul_532:CNode_574{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: CNode_571, [2]: CNode_573}
#   5: @22matmul_532:input{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Reshape, [1]: input, [2]: CNode_574}
#   6: @22matmul_532:CNode_575{[0]: ValueNode<Primitive> Return, [1]: input}


subgraph attr:
subgraph instance: 2matmul_533 : 0x16e02c20
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9601/def matmul(input, other):/
subgraph @2matmul_533 parent: [subgraph @2matmul_396]() {
  %1(input) = $(2matmul_396):S_Prim__expand[constexpr_prim: Bool(1)](%para21_input, I64(2))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9678/    input = _expand(input, 2)/
  Return(%1)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9681/        if rank_(input) > 2:/
}
# Order:
#   1: @2matmul_533:CNode_576{[0]: ValueNode<Primitive> Return, [1]: input}


subgraph attr:
subgraph instance: _broadcast_to_544 : 0x16dfd8c0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9593/def _broadcast_to(x, shape_cur, shape_to, ndim_to):/
subgraph @_broadcast_to_544(%para80_x, %para81_shape_cur, %para82_shape_to, %para83_ndim_to) {
  %1(CNode_577) = call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9595/    tile_size_op = _get_cache_prim(TileSize)()/
  %2(tile_size_op) = %1()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9595/    tile_size_op = _get_cache_prim(TileSize)()/
  %3(size) = %2(%para81_shape_cur, %para82_shape_to, %para83_ndim_to)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9596/    size = tile_size_op(shape_cur, shape_to, ndim_to)/
  %4(CNode_578) = call @stop_gradient_90(%3)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9597/    F.stop_gradient(size)/
  %5(CNode_579) = StopGradient(%4)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9593/def _broadcast_to(x, shape_cur, shape_to, ndim_to):/
  %6(CNode_580) = S_Prim_Tile[output_names: ["output"], input_names: ["x", "multiples"]](%para80_x, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9598/    return tile_(x, size)/
  %7(CNode_581) = Depend[side_effect_propagate: I64(1)](%6, %5)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9598/    return tile_(x, size)/
  Return(%7)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:9598/    return tile_(x, size)/
}
# Order:
#   1: @_broadcast_to_544:CNode_577{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations._inner_ops.TileSize'}
#   2: @_broadcast_to_544:tile_size_op{[0]: CNode_577}
#   3: @_broadcast_to_544:size{[0]: tile_size_op, [1]: param_shape_cur, [2]: param_shape_to, [3]: param_ndim_to}
#   4: @_broadcast_to_544:CNode_578{[0]: ValueNode<FuncGraph> stop_gradient_90, [1]: size}
#   5: @_broadcast_to_544:CNode_580{[0]: ValueNode<DoSignaturePrimitive> S_Prim_Tile, [1]: param_x, [2]: size}
#   6: @_broadcast_to_544:CNode_582{[0]: ValueNode<Primitive> Return, [1]: CNode_581}


subgraph attr:
after_block : 1
subgraph instance: 3sum_555 : 0x16dc34f0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @3sum_555 parent: [subgraph @sum_47]() {
  %1(CNode_583) = getattr(%para23_input, "dtype")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %2(CNode_584) = S_Prim_equal(%1, Bool)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %3(CNode_585) = Cond(%2, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %4(CNode_586) = Switch(%3, @3sum_587, @3sum_588)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %5(CNode_589) = %4()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
  %6(CNode_591) = call @4sum_590(%5)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  Return(%6)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
}
# Order:
#   1: @3sum_555:CNode_583{[0]: ValueNode<Primitive> getattr, [1]: param_input, [2]: ValueNode<StringImm> dtype}
#   2: @3sum_555:CNode_584{[0]: ValueNode<DoSignaturePrimitive> S_Prim_equal, [1]: CNode_583, [2]: ValueNode<Bool> Bool}
#   3: @3sum_555:CNode_585{[0]: ValueNode<Primitive> Cond, [1]: CNode_584, [2]: ValueNode<BoolImm> false}
#   4: @3sum_555:CNode_586{[0]: ValueNode<Primitive> Switch, [1]: CNode_585, [2]: ValueNode<FuncGraph> 3sum_587, [3]: ValueNode<FuncGraph> 3sum_588}
#   5: @3sum_555:CNode_589{[0]: CNode_586}
#   6: @3sum_555:CNode_591{[0]: ValueNode<FuncGraph> 4sum_590, [1]: CNode_589}
#   7: @3sum_555:CNode_592{[0]: ValueNode<Primitive> Return, [1]: CNode_591}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_558 : 0x16b51770
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_558 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_499]() {
  %1(output) = $(mindspore_nn_layer_conv_Conv2d_construct_499):S_Prim_Conv2D[kernel_size: (I64(3), I64(3)), mode: I64(1), out_channel: I64(32), input_names: ["x", "w"], pad: (I64(1), I64(1), I64(1), I64(1)), pad_mode: I64(0), format: "NCHW", pad_list: (I64(1), I64(1), I64(1), I64(1)), groups: I64(1), stride: (I64(1), I64(1), I64(1), I64(1)), group: I64(1), dilation: (I64(1), I64(1), I64(1), I64(1)), output_names: ["output"]](%para71_x, %para7_encoder.conv_stack.5.stack.0.res_block.1.weight)
      : (<null>, <Ref[Tensor[Float32]], (32, 128, 3, 3), ref_key=:encoder.conv_stack.5.stack.0.res_block.1.weight>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/1-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:361/        output = self.conv2d(x, self.weight)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/1-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:364/        return output/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_558:CNode_593{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
subgraph instance: mindspore_nn_layer_conv_Conv2d_construct_561 : 0x16ac1fd0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:360/    def construct(self, x):/
subgraph @mindspore_nn_layer_conv_Conv2d_construct_561 parent: [subgraph @mindspore_nn_layer_conv_Conv2d_construct_506]() {
  %1(output) = $(mindspore_nn_layer_conv_Conv2d_construct_506):S_Prim_Conv2D[kernel_size: (I64(1), I64(1)), mode: I64(1), out_channel: I64(128), input_names: ["x", "w"], pad: (I64(0), I64(0), I64(0), I64(0)), pad_mode: I64(1), format: "NCHW", pad_list: (I64(0), I64(0), I64(0), I64(0)), groups: I64(1), stride: (I64(1), I64(1), I64(1), I64(1)), group: I64(1), dilation: (I64(1), I64(1), I64(1), I64(1)), output_names: ["output"]](%para73_x, %para8_encoder.conv_stack.5.stack.0.res_block.3.weight)
      : (<null>, <Ref[Tensor[Float32]], (128, 32, 1, 1), ref_key=:encoder.conv_stack.5.stack.0.res_block.3.weight>) -> (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/3-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:361/        output = self.conv2d(x, self.weight)/
  Return(%1)
      : (<null>)
      #scope: (Default/encoder-Encoder/conv_stack-SequentialCell/5-ResidualStack/stack-CellList/0-ResidualLayer/res_block-SequentialCell/3-Conv2d)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/nn/layer/conv.py:364/        return output/
}
# Order:
#   1: @mindspore_nn_layer_conv_Conv2d_construct_561:CNode_594{[0]: ValueNode<Primitive> Return, [1]: output}


subgraph attr:
after_block : 1
subgraph instance: 4sum_590 : 0x16dc8080
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @4sum_590 parent: [subgraph @sum_47](%para84_) {
  %1(CNode_595) = S_Prim_is_not(%para26_dtype, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
  %2(CNode_596) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
  %3(CNode_597) = Switch(%2, @4sum_598, @4sum_599)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
  %4(CNode_600) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
  %5(CNode_602) = call @5sum_601(%4)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
}
# Order:
#   1: @4sum_590:CNode_595{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_not, [1]: param_dtype, [2]: ValueNode<None> None}
#   2: @4sum_590:CNode_596{[0]: ValueNode<Primitive> Cond, [1]: CNode_595, [2]: ValueNode<BoolImm> false}
#   3: @4sum_590:CNode_597{[0]: ValueNode<Primitive> Switch, [1]: CNode_596, [2]: ValueNode<FuncGraph> 4sum_598, [3]: ValueNode<FuncGraph> 4sum_599}
#   4: @4sum_590:CNode_600{[0]: CNode_597}
#   5: @4sum_590:CNode_602{[0]: ValueNode<FuncGraph> 5sum_601, [1]: CNode_600}
#   6: @4sum_590:CNode_603{[0]: ValueNode<Primitive> Return, [1]: CNode_602}


subgraph attr:
subgraph instance: 3sum_587 : 0x16dc6b90
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @3sum_587 parent: [subgraph @sum_47]() {
  %1(CNode_604) = getattr(%para23_input, "astype")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12018/        input = input.astype(mstype.int64)/
  %2(input) = %1(I64)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12018/        input = input.astype(mstype.int64)/
  Return(%2)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12018/        input = input.astype(mstype.int64)/
}
# Order:
#   1: @3sum_587:CNode_604{[0]: ValueNode<Primitive> getattr, [1]: param_input, [2]: ValueNode<StringImm> astype}
#   2: @3sum_587:input{[0]: CNode_604, [1]: ValueNode<Int> Int64}
#   3: @3sum_587:CNode_605{[0]: ValueNode<Primitive> Return, [1]: input}


subgraph attr:
subgraph instance: 3sum_588 : 0x16dc5f10
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @3sum_588 parent: [subgraph @sum_47]() {
  Return(%para23_input)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12017/    if input.dtype == mstype.bool_:/
}
# Order:
#   1: @3sum_588:CNode_606{[0]: ValueNode<Primitive> Return, [1]: param_input}


subgraph attr:
after_block : 1
subgraph instance: 5sum_601 : 0x16dccab0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @5sum_601 parent: [subgraph @sum_47](%para85_) {
  %1(CNode_607) = S_Prim_is_not(%para24_dim, None)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
  %2(CNode_608) = Cond(%1, Bool(0))
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
  %3(CNode_609) = Switch(%2, @5sum_610, @5sum_611)
      : (<null>, <null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
  %4(CNode_612) = %3()
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
  %5(CNode_614) = call @6sum_613(%4)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk3/katekong/magvit/videogvt/models/vqvae/vector_quantizer.py:47/            ops.sum(self.embedding.embedding_table.value().pow(2), dim=1) - 2 * \/
  Return(%5)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12022/    if dim is not None:/
}
# Order:
#   1: @5sum_601:CNode_615{[0]: ValueNode<FuncGraph> _get_cache_prim_19, [1]: ValueNode<ClassType> class 'mindspore.ops.operations.math_ops.ReduceSum'}
#   2: @5sum_601:CNode_616{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: ValueNode<StringImm> keep_dims}
#   3: @5sum_601:CNode_617{[0]: ValueNode<DoSignaturePrimitive> S_Prim_MakeTuple, [1]: param_keepdim}
#   4: @5sum_601:CNode_618{[0]: ValueNode<DoSignaturePrimitive> S_Prim_make_dict, [1]: CNode_616, [2]: CNode_617}
#   5: @5sum_601:reduce_sum{[0]: ValueNode<UnpackCall> MetaFuncGraph-unpack_call.619, [1]: CNode_615, [2]: CNode_618}
#   6: @5sum_601:CNode_607{[0]: ValueNode<DoSignaturePrimitive> S_Prim_is_not, [1]: param_dim, [2]: ValueNode<None> None}
#   7: @5sum_601:CNode_608{[0]: ValueNode<Primitive> Cond, [1]: CNode_607, [2]: ValueNode<BoolImm> false}
#   8: @5sum_601:CNode_609{[0]: ValueNode<Primitive> Switch, [1]: CNode_608, [2]: ValueNode<FuncGraph> 5sum_610, [3]: ValueNode<FuncGraph> 5sum_611}
#   9: @5sum_601:CNode_612{[0]: CNode_609}
#  10: @5sum_601:CNode_614{[0]: ValueNode<FuncGraph> 6sum_613, [1]: CNode_612}
#  11: @5sum_601:CNode_620{[0]: ValueNode<Primitive> Return, [1]: CNode_614}


subgraph attr:
subgraph instance: 4sum_598 : 0x16dcb5c0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @4sum_598 parent: [subgraph @4sum_590]() {
  %1(CNode_621) = getattr(%para84_input, "astype")
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12020/        input = input.astype(dtype)/
  %2(input) = %1(%para26_dtype)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12020/        input = input.astype(dtype)/
  Return(%2)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12020/        input = input.astype(dtype)/
}
# Order:
#   1: @4sum_598:CNode_621{[0]: ValueNode<Primitive> getattr, [1]: param_input, [2]: ValueNode<StringImm> astype}
#   2: @4sum_598:input{[0]: CNode_621, [1]: param_dtype}
#   3: @4sum_598:CNode_622{[0]: ValueNode<Primitive> Return, [1]: input}


subgraph attr:
subgraph instance: 4sum_599 : 0x16dca8c0
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @4sum_599 parent: [subgraph @4sum_590]() {
  Return(%para84_input)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12019/    if dtype is not None:/
}
# Order:
#   1: @4sum_599:CNode_623{[0]: ValueNode<Primitive> Return, [1]: param_input}


subgraph attr:
after_block : 1
subgraph instance: 6sum_613 : 0x16dd2430
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @6sum_613(%para86_) {
  Return(%para86_out)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12026/    return out/
}
# Order:
#   1: @6sum_613:CNode_624{[0]: ValueNode<Primitive> Return, [1]: param_out}


subgraph attr:
subgraph instance: 5sum_610 : 0x16dd1250
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @5sum_610 parent: [subgraph @5sum_601]() {
  %1(CNode_615) = $(5sum_601):call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %2(CNode_616) = $(5sum_601):S_Prim_MakeTuple("keep_dims")
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %3(CNode_617) = $(5sum_601):S_Prim_MakeTuple(%para25_keepdim)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %4(CNode_618) = $(5sum_601):S_Prim_make_dict(%2, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %5(reduce_sum) = $(5sum_601):UnpackCall_unpack_call(%1, %4)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %6(out) = %5(%para85_input, %para24_dim)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12023/        out = reduce_sum(input, dim)/
  Return(%6)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12023/        out = reduce_sum(input, dim)/
}
# Order:
#   1: @5sum_610:out{[0]: reduce_sum, [1]: param_input, [2]: param_dim}
#   2: @5sum_610:CNode_625{[0]: ValueNode<Primitive> Return, [1]: out}


subgraph attr:
subgraph instance: 5sum_611 : 0x16dd0150
# In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:11954/def sum(input, dim=None, keepdim=False, *, dtype=None):/
subgraph @5sum_611 parent: [subgraph @5sum_601]() {
  %1(CNode_615) = $(5sum_601):call @_get_cache_prim_19(ClassType)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %2(CNode_616) = $(5sum_601):S_Prim_MakeTuple("keep_dims")
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %3(CNode_617) = $(5sum_601):S_Prim_MakeTuple(%para25_keepdim)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %4(CNode_618) = $(5sum_601):S_Prim_make_dict(%2, %3)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %5(reduce_sum) = $(5sum_601):UnpackCall_unpack_call(%1, %4)
      : (<null>, <null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12021/    reduce_sum = _get_cache_prim(P.ReduceSum)(keep_dims=keepdim)/
  %6(out) = %5(%para85_input)
      : (<null>) -> (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12025/        out = reduce_sum(input)/
  Return(%6)
      : (<null>)
      #scope: (Default/vector_quantization-VectorQuantizer)
      # In file /disk1/mindone/miniconda3/envs/ms22_py37_kate/lib/python3.8/site-packages/mindspore/ops/function/math_func.py:12025/        out = reduce_sum(input)/
}
# Order:
#   1: @5sum_611:out{[0]: reduce_sum, [1]: param_input}
#   2: @5sum_611:CNode_626{[0]: ValueNode<Primitive> Return, [1]: out}


